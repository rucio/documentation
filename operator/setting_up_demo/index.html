<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-operator/setting_up_demo" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Setting up a Rucio demo environment | Rucio Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rucio.github.io/documentation/operator/setting_up_demo"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Setting up a Rucio demo environment | Rucio Documentation"><meta data-rh="true" name="description" content="Prerequisites"><meta data-rh="true" property="og:description" content="Prerequisites"><link data-rh="true" rel="icon" href="/documentation/img/android-chrome-512x512.png"><link data-rh="true" rel="canonical" href="https://rucio.github.io/documentation/operator/setting_up_demo"><link data-rh="true" rel="alternate" href="https://rucio.github.io/documentation/operator/setting_up_demo" hreflang="en"><link data-rh="true" rel="alternate" href="https://rucio.github.io/documentation/operator/setting_up_demo" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NDP6TP9QYQ-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Setting up a Rucio demo environment","item":"https://rucio.github.io/documentation/operator/setting_up_demo"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Rucio Documentation" href="/documentation/opensearch.xml">

<link rel="stylesheet" href="/documentation/css/custom.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/documentation/assets/css/styles.6eee9218.css">
<script src="/documentation/assets/js/runtime~main.d647a175.js" defer="defer"></script>
<script src="/documentation/assets/js/main.434efbf9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/documentation/img/rucio_horizontaled_black.svg"><link rel="preload" as="image" href="/documentation/img/rucio_horizontaled_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><div class="navbar__logo"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Rucio Documentation</b></a><a href="/documentation/html/client_api/accountclient.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Python Client API</a><a class="navbar__item navbar__link" href="/documentation/bin/rucio">Command Line Client</a><a href="/documentation/html/rest_api_doc.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">REST API</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/documentation/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/started/before_you_get_started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/user/setting_up_the_rucio_client">User</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/documentation/operator/setting_up_demo">Operator</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentation/operator/setting_up_demo">Setting up a Rucio demo environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/kubernetes">Setting up Rucio on Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/installing_server">Installing Rucio Server</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/documentation/operator/policy_packages/policy_packages_overview">Policy Packages</a><button aria-label="Expand sidebar category &#x27;Policy Packages&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/installing_daemons">Installing Rucio Daemons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/administration">Administration Tricks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/configuration_parameters">Configuration parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/database">Database Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/did_meta">DID Metadata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/k8s_guide">A Kubernetes tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/monitoring">Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/multi_vo_rucio">Multi-VO Rucio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/notifications">Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/qos_rse_config">QoS RSE Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/s3_rse_config">S3 Storage Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/suspicious-replica-recoverer">Suspicious Replica Recoverer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/documentation/operator_transfers/configure-rucio-fts3-plugins">Transfers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/documentation/bin/rucio-abacus-account">Executables</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/developer/dependency_management">Developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/project_organisation">About Us</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Operator</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Setting up a Rucio demo environment</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Setting up a Rucio demo environment</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>We provide a containerised version of the Rucio development environment
for a quick start. Our containers are ready-made for Docker, which means
you need to have a working Docker installation. To install Docker for
your platform, please refer to the <a href="https://docs.docker.com/install/" target="_blank" rel="noopener noreferrer"><strong>Docker installation
guide</strong></a>, for example, for CentOS
<a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener noreferrer"><strong>follow these instructions for the Docker Community
Edition</strong></a>.
Please make sure that you install this recent Docker version especially
if you are on CentOS, i.e. its default version is ancient and does not
support some features we rely on.</p>
<p>Start the Docker daemon with <code>sudo systemctl start docker</code>.
You can confirm that Docker is running properly by executing (might need
<code>sudo</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run hello-world</span><br></span></code></pre></div></div>
<p>If successful, this will print an informational message telling you that
you are ready to go. Now, also install the <code>docker-compose</code>
helper tool with <code>sudo yum install docker-compose</code> (might
need <a href="https://fedoraproject.org/wiki/EPEL" target="_blank" rel="noopener noreferrer"><strong>EPEL</strong></a> enabled). You are now
ready to install the Rucio development environment.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-the-environment">Preparing the environment<a href="#preparing-the-environment" class="hash-link" aria-label="Direct link to Preparing the environment" title="Direct link to Preparing the environment">​</a></h2>
<p>The first step is to check if SELinux is running. SELinux will block
access to the directories mounted inside the container, and so depending
on you node might need to be put in permissive mode with <code>setenforce permissive</code>.</p>
<p>The second step is to fork the <a href="https://github.com/rucio/rucio" target="_blank" rel="noopener noreferrer"><strong>main Rucio repository on
GitHub</strong></a> by clicking the yellow Fork Star
button, and then clone your private forked Rucio repository to your
<code>/dev/rucio</code>. Afterwards add the main upstream repository
as an additional remote to be able to submit pull requests later on:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/dev</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">git clone git@github.com:&lt;your_username&gt;/rucio.git</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd rucio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">git remote add upstream git@github.com:rucio/rucio.git</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">git fetch --all</span><br></span></code></pre></div></div>
<p>Now, ensure that the <code>.git/config</code> is proper, i.e.,
mentioning your full name and email address, and create the
<code>.githubtoken</code> file that contains a full access token from
<a href="https://github.com/settings/tokens" target="_blank" rel="noopener noreferrer"><strong>Github Account Settings</strong></a>.</p>
<p>Next, startup the Rucio development environment with docker-compose.
There are three different types: a standard one to just run the
unittests and do basic development, which includes just Rucio without
any transfer capabilities. One slightly larger one, which includes the
File Transfer Service (FTS) and three XrootD storage servers to develop
upload/download and transfers capabilities. And a third large one, which
adds the full monitoring stack with Logstash, Elasticsearch, Kibana and
Grafana.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-standard-environment">Using the standard environment<a href="#using-the-standard-environment" class="hash-link" aria-label="Direct link to Using the standard environment" title="Direct link to Using the standard environment">​</a></h2>
<p>Run the containers using docker-compose (again might need
<code>sudo</code>):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose --file etc/docker/dev/docker-compose.yml up -d</span><br></span></code></pre></div></div>
<p>And verify that it is running properly:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker ps</span><br></span></code></pre></div></div>
<p>This should show you a few running containers: the Rucio server, the
PostgreSQL database and the Graphite monitoring.</p>
<p>Finally, you can jump into the container with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -it dev-rucio-1 /bin/bash</span><br></span></code></pre></div></div>
<p>To verify that everything is in order, you can now either run the full
unit tests or only set up the database. Running the full testing suite
takes ~10 minutes:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tools/run_tests.sh</span><br></span></code></pre></div></div>
<p>Alternatively, you can bootstrap the test environment once with the
<code>-i</code>option and then selectively or repeatedly run test case
modules, test case groups, or even single test cases, for example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tools/run_tests.sh -i</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pytest -v --full-trace lib/rucio/tests/test_replica.py</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pytest -v --full-trace lib/rucio/tests/test_replica.py:TestReplicaCore</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pytest -v --full-trace lib/rucio/tests/test_replica.py:TestReplicaCore.test_delete_replicas_from_datasets</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-environment-including-storage">Using the environment including storage<a href="#using-the-environment-including-storage" class="hash-link" aria-label="Direct link to Using the environment including storage" title="Direct link to Using the environment including storage">​</a></h2>
<p>Again run the containers using docker-compose:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose --file etc/docker/dev/docker-compose.yml --profile storage up -d</span><br></span></code></pre></div></div>
<p>This should show you a few more running containers: the Rucio server,
the PostgreSQL database, FTS and its associated MySQL database, the
Graphite monitoring, and three XrootD storage servers.</p>
<p>With this container you can upload and download data to/from the storage
and submit data transfers. To set this up, add the <code>-r</code>
option to the setup.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tools/run_tests.sh -ir</span><br></span></code></pre></div></div>
<p>This creates a few random files and uploads them, creates a few datasets
and containers, and requests a replication rule for the container, which
starts in state REPLICATING. To demonstrate the transfer capability, the
daemons can be run in single-execution mode in order:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rule-info &lt;rule-id&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-submitter --run-once</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-poller --run-once  --older-than 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-finisher --run-once</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rule-info &lt;rule-id&gt;</span><br></span></code></pre></div></div>
<p>On the second display of the rule, its state has cleared to OK.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-the-environment-including-monitoring">Using the environment including monitoring<a href="#using-the-environment-including-monitoring" class="hash-link" aria-label="Direct link to Using the environment including monitoring" title="Direct link to Using the environment including monitoring">​</a></h2>
<p>Again run the containers using docker-compose:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker-compose --file etc/docker/dev/docker-compose.yml --profile storage --profile monitoring up -d</span><br></span></code></pre></div></div>
<p>Now you will have the same containers as before plus a full monitoring
stack with Logstash, Elasticsearch, Kibana and Grafana.</p>
<p>To create some events and write them to Elasticsearch first run again
the tests as before:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tools/run_tests.sh -ir</span><br></span></code></pre></div></div>
<p>Then you will have to run the transfer daemons (conveyor-*) and
messaging daemon (hermes) to send the events to ActiveMQ. There a script
for that which repeats these daemons in single execution mode from the
section in a loop:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">run_daemons</span><br></span></code></pre></div></div>
<p>When all the daemons ran you will be able to find the events in Kibana.
If you run the docker environment on you local machine you can access
Kibana at <code>&lt;http://localhost:5601&gt;</code>. The necessary index pattern will be
added automatically. There is also one dashboard available in Kibana. If
it is running on remote machine you can SSH forward it:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ssh -L 5601:127.0.0.1:5601 &lt;hostname&gt;</span><br></span></code></pre></div></div>
<p>Additionally, there is also a Grafana server running with one simple
dashboard. You can access it at <code>&lt;http://localhost:3000&gt;</code>. The default
credentials are &quot;admin/admin&quot;. Also ActiveMQ web console can be
accessed at <code>&lt;http://localhost:8161&gt;</code>.</p>
<p>If you would like to continuously create some transfers and events there
are scripts available for that. Open two different shells and in one
run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">create_monit_data</span><br></span></code></pre></div></div>
<p>And in the other run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">run_daemons</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a href="#development" class="hash-link" aria-label="Direct link to Development" title="Direct link to Development">​</a></h2>
<p>The idea for containerised development is that you use your host machine
to edit the files, and test the changes within the container
environment. On your host machine, you should be able to:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ~/dev/rucio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">emacs &lt;file&gt;</span><br></span></code></pre></div></div>
<p>To see your changes in action the recommended way is to jump twice into
the container in parallel. One terminal to follow the output of the
Rucio server with a shortcut to tail the logfiles
(<code>logshow</code>), and one terminal to actually run interactive
commands:</p>
<p>From your host, get a separate Terminal 1 (the Rucio &quot;server log
show&quot;):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -it dev-rucio-1 /bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logshow</span><br></span></code></pre></div></div>
<p>Terminal 1 can now be left open, and then from your host go into a new
Terminal 2 (the &quot;interactive&quot; terminal):</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -it dev-rucio-1 /bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio whoami</span><br></span></code></pre></div></div>
<p>The command will output in Terminal 2, and at the same time the server
debug output will be shown in Terminal 1.</p>
<p>The same <code>logshow</code> is also available in the FTS container:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -it dev-fts-1 /bin/bash</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">logshow</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="development-tricks">Development tricks<a href="#development-tricks" class="hash-link" aria-label="Direct link to Development tricks" title="Direct link to Development tricks">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="server-changes">Server changes<a href="#server-changes" class="hash-link" aria-label="Direct link to Server changes" title="Direct link to Server changes">​</a></h3>
<p>If you edit server-side files, e.g. in <code>lib/rucio/web</code>, and
your changes are not showing up then it is usually helpful to flush the
memcache and force the webserver to restart without having to restart
the container. Inside the container execute:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">echo &#x27;flush_all&#x27; | nc localhost 11211 &amp;&amp; httpd -k graceful**</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="database-access">Database access<a href="#database-access" class="hash-link" aria-label="Direct link to Database access" title="Direct link to Database access">​</a></h3>
<p>The default database is PostgreSQL, and <code>docker-compose</code> is
configured to open its port to the host machine. Using your favourite
SQL navigator, e.g., <a href="https://dbeaver.io" target="_blank" rel="noopener noreferrer"><strong>DBeaver</strong></a>, you can connect to
the database using the default access on <code>localhost:5432</code> to
database name <code>rucio</code>, schema name <code>dev</code>, with
username <code>rucio</code> and password <code>secret</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-is-eating-my-disk-space">Docker is eating my disk space<a href="#docker-is-eating-my-disk-space" class="hash-link" aria-label="Direct link to Docker is eating my disk space" title="Direct link to Docker is eating my disk space">​</a></h3>
<p>You can reclaim this with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker system prune -f --volumes</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="where-do-i-find-the-dockerfile">Where do I find the Dockerfile<a href="#where-do-i-find-the-dockerfile" class="hash-link" aria-label="Direct link to Where do I find the Dockerfile" title="Direct link to Where do I find the Dockerfile">​</a></h3>
<p>This container can be found on Dockerhub as
<code>rucio/rucio-dev</code>, and the corresponding
<a href="https://github.com/rucio/containers/tree/master/dev" target="_blank" rel="noopener noreferrer"><strong>Dockerfile</strong></a> is
also available. It provides a Rucio environment which allows you to
mount your local code in the containers <code>bin</code>,
<code>lib</code>, and <code>tools</code> directory. The container is
set up to run against a PostgreSQL database with fsync and most
durability features for the WAL disabled to improve testing IO
throughput. Tests and checks can be run against the development code
without having to rebuild the container.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="i-need-a-docker-based-on-another-branch-not-ruciomaster">I need a Docker based on another branch! (not rucio/master)<a href="#i-need-a-docker-based-on-another-branch-not-ruciomaster" class="hash-link" aria-label="Direct link to I need a Docker based on another branch! (not rucio/master)" title="Direct link to I need a Docker based on another branch! (not rucio/master)">​</a></h3>
<p>In such cases, you can download the Rucio container files and e.g. choose
to modify the dev container before build:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd /opt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo git clone https://github.com/rucio/containers</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd ../containers/dev</span><br></span></code></pre></div></div>
<p>Change anything you need, e.g. the code branch cloned to your docker
container:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain"># from</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN git clone https://github.com/rucio/rucio.git /tmp/rucio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># to e.g.:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">RUN git clone --single-branch --branch next https://github.com/rucio/rucio.git /tmp/rucio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#build your docker</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo docker build -t rucio/rucio-dev</span><br></span></code></pre></div></div>
<p>Compose as usual using docker-compose:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">cd /opt/rucio</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">sudo docker-compose --file etc/docker/dev/docker-compose.yml up -d</span><br></span></code></pre></div></div>
<p>Start the daemons</p>
<p>Daemons are not running in the docker environment, but all daemons
support single-execution mode with the --run-once argument. Reset the
system first with:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">tools/run_tests.sh -ir</span><br></span></code></pre></div></div>
<p>Some files are created. Let&#x27;s add them to a new dataset:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio add-dataset test:mynewdataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio attach test:mynewdataset test:file1 test:file2 test:file3 test:file4</span><br></span></code></pre></div></div>
<p>If you run the command below, the files are not in the RSE XRD3, but
only in XRD1 and 2.:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ **rucio list-file-replicas test:mynewdataset**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+-------+-------+-----------+----------+-----------------------------------+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| SCOPE | NAME  | FILESIZE  | ADLER32  | RSE: REPLICA                      |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|-------|-------|-----------|----------|-----------------------------------|</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file1 | 10.486 MB | 141a641e | XRD1: root://xrd1:1094//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file2 | 10.486 MB | fdfa7eea | XRD1: root://xrd1:1094//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file3 | 10.486 MB | c669167d | XRD2: root://xrd2:1095//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file4 | 10.486 MB | 65786e49 | XRD2: root://xrd2:1095//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+-------+-------+-----------+----------+-----------------------------------+</span><br></span></code></pre></div></div>
<p>So let&#x27;s add a new rule on our new dataset to oblige Rucio to create
replicas also on XRD3:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio add-rule test:mynewdataset 1 XRD3**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1aadd685d891400dba050ad43e71fea9**</span><br></span></code></pre></div></div>
<p>Now we can check the status of the rule. We will see there are 4 files
in <code>Replicating</code> state:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rule-info 1aadd685d891400dba050ad43e71fea9|grep Locks**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Locks OK/REPLICATING/STUCK: 0/4/0**</span><br></span></code></pre></div></div>
<p>Now we can run the daemons. First the rule evaluation daemon
(judge-evaluator) will pick up our rule. Then the transfer submitter
daemon (conveyor-submitter) will send the newly created transfers
requests to the FTS server. After that, the transfer state check daemon
(conveyor-poller) will retrieve from FTS the transfer state information.
Finally, the transfer sign-off daemon (conveyor-finisher) updates the
internal state of the Rucio catalogue to reflect the changes.:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-judge-evaluator --run-once**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-submitter --run-once**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-poller --run-once**</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio-conveyor-finisher --run-once**</span><br></span></code></pre></div></div>
<p>If we see the state of the rule now, we see the locks are OK:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rule-info 1aadd685d891400dba050ad43e71fea9|grep Locks</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Locks OK/REPLICATING/STUCK: 4/0/0**</span><br></span></code></pre></div></div>
<p>And if we look at the replicas of the dataset, we see the there are
replicas of the files also in XRD3:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">$ rucio list-file-replicas test:mynewdataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+-------+-------+-----------+----------+-----------------------------------+</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| SCOPE | NAME  | FILESIZE  | ADLER32  | RSE: REPLICA                      |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|-------|-------|-----------|----------|-----------------------------------|</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file1 | 10.486 MB | 141a641e | XRD3: root://xrd3:1096//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file1 | 10.486 MB | 141a641e | XRD1: root://xrd1:1094//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file2 | 10.486 MB | fdfa7eea | XRD3: root://xrd3:1096//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file2 | 10.486 MB | fdfa7eea | XRD1: root://xrd1:1094//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file3 | 10.486 MB | c669167d | XRD2: root://xrd2:1095//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file3 | 10.486 MB | c669167d | XRD3: root://xrd3:1096//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file4 | 10.486 MB | 65786e49 | XRD2: root://xrd2:1095//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| test  | file4 | 10.486 MB | 65786e49 | XRD3: root://xrd3:1096//rucio/... |</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">+-------+-------+-----------+----------+-----------------------------------+</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rucio/documentation/tree/main/docs/../docs/operator/setting_up_demo.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-06-26T07:48:24.000Z" itemprop="dateModified">Jun 26, 2025</time></b> by <b>Dimitris Xenakis</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/documentation/user/developing_with_rucio"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Developing with Rucio</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/documentation/operator/kubernetes"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Setting up Rucio on Kubernetes</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#preparing-the-environment" class="table-of-contents__link toc-highlight">Preparing the environment</a></li><li><a href="#using-the-standard-environment" class="table-of-contents__link toc-highlight">Using the standard environment</a></li><li><a href="#using-the-environment-including-storage" class="table-of-contents__link toc-highlight">Using the environment including storage</a></li><li><a href="#using-the-environment-including-monitoring" class="table-of-contents__link toc-highlight">Using the environment including monitoring</a></li><li><a href="#development" class="table-of-contents__link toc-highlight">Development</a></li><li><a href="#development-tricks" class="table-of-contents__link toc-highlight">Development tricks</a><ul><li><a href="#server-changes" class="table-of-contents__link toc-highlight">Server changes</a></li><li><a href="#database-access" class="table-of-contents__link toc-highlight">Database access</a></li><li><a href="#docker-is-eating-my-disk-space" class="table-of-contents__link toc-highlight">Docker is eating my disk space</a></li><li><a href="#where-do-i-find-the-dockerfile" class="table-of-contents__link toc-highlight">Where do I find the Dockerfile</a></li><li><a href="#i-need-a-docker-based-on-another-branch-not-ruciomaster" class="table-of-contents__link toc-highlight">I need a Docker based on another branch! (not rucio/master)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/documentation/img/rucio_horizontaled_black.svg" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/documentation/img/rucio_horizontaled_white.svg" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright © 2023 CERN</div></div></div></footer></div>
</body>
</html>