<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-operator/installing_server" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Installing Rucio Server | Rucio Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://rucio.github.io/documentation/operator/installing_server"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Installing Rucio Server | Rucio Documentation"><meta data-rh="true" name="description" content="Prerequisites"><meta data-rh="true" property="og:description" content="Prerequisites"><link data-rh="true" rel="icon" href="/documentation/img/android-chrome-512x512.png"><link data-rh="true" rel="canonical" href="https://rucio.github.io/documentation/operator/installing_server"><link data-rh="true" rel="alternate" href="https://rucio.github.io/documentation/operator/installing_server" hreflang="en"><link data-rh="true" rel="alternate" href="https://rucio.github.io/documentation/operator/installing_server" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NDP6TP9QYQ-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Installing Rucio Server","item":"https://rucio.github.io/documentation/operator/installing_server"}]}</script><link rel="search" type="application/opensearchdescription+xml" title="Rucio Documentation" href="/documentation/opensearch.xml">

<link rel="stylesheet" href="/documentation/css/custom.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,500,700&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap">
<script src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/documentation/assets/css/styles.1dc85473.css">
<script src="/documentation/assets/js/runtime~main.cc73ba61.js" defer="defer"></script>
<script src="/documentation/assets/js/main.709ff640.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/documentation/img/rucio_horizontaled_black.svg"><link rel="preload" as="image" href="/documentation/img/rucio_horizontaled_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/documentation/"><div class="navbar__logo"><img src="/documentation/img/rucio_horizontaled_black.svg" alt="" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/documentation/img/rucio_horizontaled_white.svg" alt="" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Rucio Documentation</b></a><a href="/documentation/html/client_api/accountclient.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Python Client API</a><a class="navbar__item navbar__link" href="/documentation/bin/rucio">Command Line Client</a><a href="/documentation/html/rest_api_doc.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">REST API</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/documentation/">Welcome</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/started/before_you_get_started">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/user/setting_up_the_rucio_client">User</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/documentation/operator/setting_up_demo">Operator</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/setting_up_demo">Setting up a Rucio demo environment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/kubernetes">Setting up Rucio on Kubernetes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/documentation/operator/installing_server">Installing Rucio Server</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/documentation/operator/policy_packages/policy_packages_overview">Policy Packages</a><button aria-label="Expand sidebar category &#x27;Policy Packages&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/installing_daemons">Installing Rucio Daemons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/configuration">Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/administration">Administration Tricks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/configuration_parameters">Configuration Parameters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/database">Database Operations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/did_meta">DID Metadata</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/jupyter_extension_operator">JupyterLab Extension</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/k8s_guide">A Kubernetes tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/monitoring">Monitoring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/multi_vo_rucio">Multi-VO Rucio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/notifications">Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/open_data">Open Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/qos_rse_config">QoS RSE Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/s3_rse_config">S3 Storage Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/documentation/operator/suspicious-replica-recoverer">Suspicious Replica Recoverer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/documentation/operator_transfers/configure-rucio-fts3-plugins">Transfers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/documentation/bin/rucio-abacus-account">Executables</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/developer/dependency_management">Developer</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/documentation/project_organisation">About Us</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/documentation/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Operator</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Installing Rucio Server</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Installing Rucio Server</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<p>The Rucio server runs on Python 2.7, 3.6 and 3.7 on any Unix-like platform.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-via-pip">Install via pip<a href="#install-via-pip" class="hash-link" aria-label="Direct link to Install via pip" title="Direct link to Install via pip">​</a></h2>
<p>Heads up: We recommend to use the docker-based install (see next section) as it
will configure many things for you automatically. Only use the pip-based install
if you have a good reason and know how to configure your webservices manually:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip install rucio</span><br></span></code></pre></div></div>
<p>This will pull the latest release from
<a href="https://pypi.python.org/pypi/rucio/" target="_blank" rel="noopener noreferrer"><strong>PyPi</strong></a>. The Rucio server also needs
several Python dependencies. These are all listed in the file
<a href="https://github.com/rucio/rucio/blob/master/requirements/requirements.server.txt" target="_blank" rel="noopener noreferrer"><code>requirements.server.txt</code></a>
and will be pulled in as necessary.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-via-docker">Install via Docker<a href="#install-via-docker" class="hash-link" aria-label="Direct link to Install via Docker" title="Direct link to Install via Docker">​</a></h2>
<p>A simple server without SSL can be started like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name rucio-server --publish 80:80 --detach rucio/rucio-server</span><br></span></code></pre></div></div>
<p>This will start up a simple server using sqlite based on an automatically
generated configuration. You can check if the server is running with</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">curl http://localhost/ping</span><br></span></code></pre></div></div>
<p>This should return the Rucio version used in the container. Any other curl
requests will not work as the database backend is not initialized as this image
is meant to be used with an already bootstrapped database backend. I.e., that
the container has to be configured to point to the correct database. There are
two ways to manage the Rucio configuration: using environment variables or by
mounting a full rucio.cfg.</p>
<p>If you want to set the connection string for the database it can be done using
the <code>RUCIO_CFG_DATABASE_DEFAULT</code> environment variable, e.g., to start a
container connecting to a MySQL DB running at <code>mysql.db</code> you could use something
like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name rucio-server \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --env RUCIO_CFG_DATABASE_DEFAULT=&quot;mysql+pymysql://rucio:rucio@mysql.db/rucio&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --publish 80:80 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span><br></span></code></pre></div></div>
<p>The are much more configuration parameters available that will be listed at the
end of this readme.</p>
<p>Another way to configure Rucio is to directly mount a complete rucio.cfg into
the container. This will then be used instead of the auto-generated one, e.g.,
if you have a rucio.cfg ready on your host system under <code>/tmp/rucio.cfg</code> you
could start a container like this:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name rucio-server \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --publish 80:80 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span><br></span></code></pre></div></div>
<p>The rucio.cfg is used to configure the database backend.</p>
<p>If you want to enable SSL you would need to set the <code>RUCIO_ENABLE_SSL</code> variable
and also need to include the host certificate, key and the the CA certificate as
volumes. E.g.,:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name rucio-server \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/ca.pem:/etc/grid-security/ca.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/hostcert.pem:/etc/grid-security/hostcert.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/hostkey.pem:/etc/grid-security/hostkey.pem \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --publish 443:443 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --env RUCIO_ENABLE_SSL=True \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span><br></span></code></pre></div></div>
<p>By default the output of the Apache web server is written directly to stdout and
stderr. If you would rather direct them into separate files it can be done using
the <code>RUCIO_ENABLE_LOGS</code> variable. The storage folder of the logs can be used as
a volume:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">docker run --name rucio-server \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/rucio.cfg:/opt/rucio/etc/rucio.cfg \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --volume /tmp/logs:/var/log/httpd \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --publish 80:80 \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --env RUCIO_ENABLE_LOGS=True \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --detach \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  rucio/rucio-server</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-variables">Environment Variables<a href="#environment-variables" class="hash-link" aria-label="Direct link to Environment Variables" title="Direct link to Environment Variables">​</a></h2>
<p>As shown in the examples above the rucio-server image can be configured using
environment variables that are passed with <code>docker run</code>. Below is a list of all
available variables and their behavior:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_enable_ssl">RUCIO_ENABLE_SSL<a href="#rucio_enable_ssl" class="hash-link" aria-label="Direct link to RUCIO_ENABLE_SSL" title="Direct link to RUCIO_ENABLE_SSL">​</a></h3>
<p>By default, the Rucio server runs without SSL on port 80. If you want to enable
SSL set this variable to <code>True</code>. If you enable SSL you will also have to provide
the host certificate and key and the certificate authority file. The server will
look for <code>hostcert.pem</code>, <code>hostkey.pem</code> and <code>ca.pem</code> under <code>/etc/grid-security</code>
so you will have to mount them as volumes. Furthermore you will also have to
expose port 443.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_ssl_protocol">RUCIO_SSL_PROTOCOL<a href="#rucio_ssl_protocol" class="hash-link" aria-label="Direct link to RUCIO_SSL_PROTOCOL" title="Direct link to RUCIO_SSL_PROTOCOL">​</a></h3>
<p>By default, the server will only accept TLSv1.2 connections. Defining this
environment variable will allow specification of a custom Apache SSLProtocol.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_ca_path">RUCIO_CA_PATH<a href="#rucio_ca_path" class="hash-link" aria-label="Direct link to RUCIO_CA_PATH" title="Direct link to RUCIO_CA_PATH">​</a></h3>
<p>If you are using SSL and want use <code>SSLCACertificatePath</code> and
<code>SSLCARevocationPath</code> you can do so by specifying the path in this variable.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_define_aliases">RUCIO_DEFINE_ALIASES<a href="#rucio_define_aliases" class="hash-link" aria-label="Direct link to RUCIO_DEFINE_ALIASES" title="Direct link to RUCIO_DEFINE_ALIASES">​</a></h3>
<p>By default, the web server is configured with all common rest endpoints except
the authentication endpoint. If you want to specify your own set of aliases you
can set this variable to <code>True</code>. The web server then expects an alias file under
<code>/opt/rucio/etc/aliases.conf</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_enable_logs">RUCIO_ENABLE_LOGS<a href="#rucio_enable_logs" class="hash-link" aria-label="Direct link to RUCIO_ENABLE_LOGS" title="Direct link to RUCIO_ENABLE_LOGS">​</a></h3>
<p>By default, the log output of the web server is written to stdout and stderr. If
you set this variable to <code>True</code> the output will be written to <code>access_log</code> and
<code>error_log</code> under <code>/var/log/httpd</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_log_level">RUCIO_LOG_LEVEL<a href="#rucio_log_level" class="hash-link" aria-label="Direct link to RUCIO_LOG_LEVEL" title="Direct link to RUCIO_LOG_LEVEL">​</a></h3>
<p>The default log level is <code>info</code>. You can change it using this
variable.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_log_format">RUCIO_LOG_FORMAT<a href="#rucio_log_format" class="hash-link" aria-label="Direct link to RUCIO_LOG_FORMAT" title="Direct link to RUCIO_LOG_FORMAT">​</a></h3>
<p>The default Rucio log format is
<code>%ht%tt%{X-Rucio-Forwarded-For}it%Tt%Dt\&quot;%{X-Rucio-Auth-Token}i\&quot;t%{X-Rucio-RequestId}it%{X-Rucio-Client-Ref}it\&quot;%r\&quot;t%\&gt;st%b</code>
You can set your own format using this variable.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_hostname">RUCIO_HOSTNAME<a href="#rucio_hostname" class="hash-link" aria-label="Direct link to RUCIO_HOSTNAME" title="Direct link to RUCIO_HOSTNAME">​</a></h3>
<p>This variable sets the server name in the apache config.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_server_admin">RUCIO_SERVER_ADMIN<a href="#rucio_server_admin" class="hash-link" aria-label="Direct link to RUCIO_SERVER_ADMIN" title="Direct link to RUCIO_SERVER_ADMIN">​</a></h3>
<p>This variable sets the server admin in the apache config.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rucio_cfg-configuration-parameters">RUCIO_CFG configuration parameters<a href="#rucio_cfg-configuration-parameters" class="hash-link" aria-label="Direct link to RUCIO_CFG configuration parameters" title="Direct link to RUCIO_CFG configuration parameters">​</a></h2>
<p>Environment variables can be used to set values for the auto-generated
rucio.cfg. The names are derived from the actual names in the configuration file
prefixed by <code>RUCIO_CFG</code>, e.g., the <code>default</code> value in the <code>database</code> section
becomes <code>RUCIO_CFG_DATABASE_DEFAULT</code>. All available environment variables are:</p>
<ul>
<li>RUCIO_CFG_COMMON_LOGDIR</li>
<li>RUCIO_CFG_COMMON_LOGLEVEL</li>
<li>RUCIO_CFG_COMMON_MAILTEMPLATEDIR</li>
<li>RUCIO_CFG_DATABASE_DEFAULT</li>
<li>RUCIO_CFG_DATABASE_SCHEMA</li>
<li>RUCIO_CFG_DATABASE_POOL_RESET_ON_RETURN</li>
<li>RUCIO_CFG_DATABASE_ECHO</li>
<li>RUCIO_CFG_DATABASE_POLL_RECYCLE</li>
<li>RUCIO_CFG_DATABASE_POOL_SIZE</li>
<li>RUCIO_CFG_DATABASE_POOL_TIMEOUT</li>
<li>RUCIO_CFG_DATABASE_MAX_OVERFLOW</li>
<li>RUCIO_CFG_DATABASE_POWUSERACCOUNT</li>
<li>RUCIO_CFG_DATABASE_USERPASSWORD</li>
<li>RUCIO_CFG_MONITOR_CARBON_SERVER</li>
<li>RUCIO_CFG_MONITOR_CARBON_PORT</li>
<li>RUCIO_CFG_MONITOR_USER_SCOPE</li>
<li>RUCIO_CFG_TRACE_TRACEDIR</li>
<li>RUCIO_CFG_TRACE_BROKERS</li>
<li>RUCIO_CFG_TRACE_PORT</li>
<li>RUCIO_CFG_TRACE_USERNAME</li>
<li>RUCIO_CFG_TRACE_PASSWORD</li>
<li>RUCIO_CFG_TRACE_TOPIC</li>
<li>RUCIO_CFG_PERMISSION_POLICY</li>
<li>RUCIO_CFG_PERMISSION_SCHEMA</li>
<li>RUCIO_CFG_PERMISSION_LFN2PFN_ALGORITHM_DEFAULT</li>
<li>RUCIO_CFG_PERMISSION_SUPPORT</li>
<li>RUCIO_CFG_PERMISSION_SUPPORT_RUCIO</li>
<li>RUCIO_CFG_WEBUI_USERCERT</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enable-oidc">Enable OIDC<a href="#enable-oidc" class="hash-link" aria-label="Direct link to Enable OIDC" title="Direct link to Enable OIDC">​</a></h2>
<p>This section describes how to enable authentication and authorization in Rucio using OpenID Connect (OIDC), OAuth2, and JSON Web Tokens (JWTs).</p>
<p>Rucio currently provides full support for INDIGO IAM, and has been tested with CILogon.
A OIDC client must be registered in the Identity Provider (IdP) with required <a href="#registering-oidc-clients-to-identity-provider-idp">info</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="registering-oidc-clients-to-identity-provider-idp">Registering OIDC Clients to Identity provider (IdP)<a href="#registering-oidc-clients-to-identity-provider-idp" class="hash-link" aria-label="Direct link to Registering OIDC Clients to Identity provider (IdP)" title="Direct link to Registering OIDC Clients to Identity provider (IdP)">​</a></h3>
<p>Rucio requires a client at the IdP with following info.</p>
<ul>
<li>
<p>Grant Type: <code>authorization_code</code> and <code>client_credentials</code></p>
</li>
<li>
<p>Scopes:</p>
<ul>
<li>Auth scopes:<!-- -->
<ul>
<li>At minimum <code>openid</code> .</li>
<li>Default in rucio <code>openid</code> and <code>profile</code>.</li>
</ul>
</li>
<li>Transfer and Deletion related scopes:<!-- -->
<ul>
<li><code>fts</code></li>
<li><code>storage.modify:&lt;path&gt;</code></li>
<li><code>storage.create:&lt;path&gt;</code></li>
<li><code>storage.read:&lt;path&gt;</code></li>
<li><code>offline_access</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>redirect_uris :</p>
<ul>
<li><code>https://&lt;RUCIO_AUTH_SERVER_HOSTNAME&gt;/auth/oidc_token</code></li>
<li><code>https://&lt;RUCIO_AUTH_SERVER_HOSTNAME&gt;/auth/oidc_code</code></li>
</ul>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Ensure your server uses HTTPS, as most Identity Providers will reject non-secure redirect URIs</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><ul>
<li>The audience value (default <code>rucio</code>) is set by the Rucio auth server during the authorization request.</li>
<li>The audience set in the <code>client_credentials</code> grant&#x27;s token request corresponds to the storage hostname(s) and FTS hostname.</li>
<li><strong>Some IdPs require these audience to be pre-registered with the client, while others don&#x27;t (like IndigoIAM).</strong></li>
</ul></div></div>
<p>Use case of different grant types:</p>
<ul>
<li><code>authorization_code</code>: This grant type is used for interactive user authentication to rucio. User must use <code>OIDC</code> authorization type.</li>
<li><code>client_credentials</code>: This grant is machine-machine interaction (daemons-IdP interactions). It is used for getting tokens for FTS and Storage(s). This is used by transfer and deletion daemons.</li>
</ul>
<p>The <code>&lt;path&gt;</code> to register depends upon your IdP&#x27;s scope matching algorithm in combination
with configuration for RSEs as described <a href="#configuring-path-for-storage-capabilities-in-rucio">here</a></p>
<p>Please save the value of <code>client_id</code> and <code>client_secret</code> after registration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="preparing-idpsecretsjson">Preparing idpsecrets.json<a href="#preparing-idpsecretsjson" class="hash-link" aria-label="Direct link to Preparing idpsecrets.json" title="Direct link to Preparing idpsecrets.json">​</a></h3>
<p>Create an <code>idpsecrets.json</code> file containing the configuration of the two IdP clients. Then mount this file to Rucio server and daemons. The path to the mounted file have to be set in <a href="#configuring-rucio-server-for-oidc-based-authentication">configuration</a>
If using Helm Chart then use mounting as <a href="https://github.com/rucio/helm-charts/tree/master/charts/rucio-server#additional-secrets" target="_blank" rel="noopener noreferrer">described here</a>.</p>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Security</div><div class="admonitionContent_BuS1"><p>Never commit <code>idpsecrets.json</code> to version control. Store the file securely (Kubernetes Secret, encrypted backup or password manager). Mount secrets as read-only in production.</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The <code>SCIM</code> section of json file is <strong>not used but required to be present due to some legacy code still present</strong>. Thus please set some random value for it.</p></div></div>
<p>Example:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;&lt;IdP_nickname&gt;&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;issuer&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;issuer_url_of_idp&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://&lt;auth_server_name&gt;/auth/oidc_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://&lt;auth_server_name&gt;/auth/oidc_code&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;client_id&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;client_secret&gt;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;SCIM&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;random&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;random&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token property">&quot;wlcg&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;issuer&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://wlcg.cloud.cnaf.infn.it/&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;redirect_uris&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_token&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://rucio-auth.cern.ch/auth/oidc_code&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fdc297fc-09 ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;APFVcga_X ...&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token property">&quot;SCIM&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;client_id&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;random&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token property">&quot;client_secret&quot;</span><span class="token operator" style="color:rgb(137, 221, 255)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;random&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-rucio-server-for-oidc-based-authentication">Configuring Rucio Server for OIDC based authentication<a href="#configuring-rucio-server-for-oidc-based-authentication" class="hash-link" aria-label="Direct link to Configuring Rucio Server for OIDC based authentication" title="Direct link to Configuring Rucio Server for OIDC based authentication">​</a></h3>
<p>Enable OIDC in <code>rucio.cfg</code>:</p>
<div class="language-cfg codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cfg codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[oidc]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Required: Path to the idpsecrets JSON file.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">idpsecrets = /path/to/your/idpsecrets.json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Required: Matches the &lt;IdP_nickname&gt; key in idpsecrets.json.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">admin_issuer = &lt;IdP_nickname&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Optional: Expected &#x27;aud&#x27; value in the user JWT. Defaults to &#x27;rucio&#x27;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># if different from default then put what you have</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">expected_audience = &#x27;rucio&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Optional: Expected scopes in the JWT. Defaults to &#x27;openid profile&#x27;.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># if different from default then put what you have</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">expected_scope = &#x27;openid profile&#x27;</span><br></span></code></pre></div></div>
<p>Each user must have an OIDC identity linked to their Rucio account. The OIDC identity consists of:</p>
<ul>
<li><code>sub</code> claim which is subject claim of user.</li>
<li><code>iss</code> claim which is issuer URL of the IdP.</li>
</ul>
<p>Example:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio account identity add --account rucio_user_account \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --type OIDC \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --id &quot;SUB=5b5e5d37-926b-4b42-8a98-a0b4b28baf18, ISS=https://wlcg.cloud.cnaf.infn.it/&quot; \</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  --email &quot;wlcg-doma-rucio@cern.ch&quot;</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><ul>
<li><code>5b5e5d37-926b-4b42-8a98-a0b4b28baf18</code> is subject claim of user and <code>https://wlcg.cloud.cnaf.infn.it/</code> is issuer url of IdP.</li>
<li>The format of <code>id</code> has single space after the comma, so be mindful of that.</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-oidc-for-transfers--deletions">Enabling OIDC for Transfers &amp; Deletions<a href="#enabling-oidc-for-transfers--deletions" class="hash-link" aria-label="Direct link to Enabling OIDC for Transfers &amp; Deletions" title="Direct link to Enabling OIDC for Transfers &amp; Deletions">​</a></h3>
<p>Rucio uses WLCG profile with <a href="https://github.com/WLCG-AuthZ-WG/common-jwt-profile/blob/master/profile.md#221-capability-based-authorization-scope" target="_blank" rel="noopener noreferrer">Capability based authorization</a> for token-based interactions with storage.
Authorization is applied at the RSE level: This means tokens are scoped to the RSE&#x27;s storage path prefix described <a href="#defining-path-for-storage-capabilities">here</a>, not to individual files or datasets. A single token grants access to perform operations on any file under the RSE&#x27;s path based on its capabilities (read, create, modify).</p>
<p>Token-based operations require:</p>
<ol>
<li>
<p>The RSE must have the davs protocol enabled.</p>
</li>
<li>
<p>The RSE must have the oidc_support attribute set to True.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rse attribute add --key oidc_support --value True RSE_NAME</span><br></span></code></pre></div></div>
</li>
<li>
<p>The RSE must be able to accept token with WLCG profile and audience as its <code>hostname</code></p>
</li>
<li>
<p>The RSE must allow permission for <a href="#defining-path-for-storage-capabilities"><code>&lt;path&gt;</code></a></p>
</li>
<li>
<p>FTS must be configured to accept token <code>fts</code> scope and <code>&lt;fts_hostname&gt;</code> audience.</p>
<ul>
<li>FTS audience config described <a href="https://fts3-docs.web.cern.ch/fts3-docs/docs/install/token_configuration.html#configuring-the-fts-rest-component" target="_blank" rel="noopener noreferrer">here</a>.</li>
<li>FTS scope config described <a href="https://fts3-docs.web.cern.ch/fts3-docs/docs/install/token_configuration.html#add-tokenprovider-information-to-the-database" target="_blank" rel="noopener noreferrer">here</a></li>
</ul>
</li>
</ol>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-path-for-storage-capabilities-in-rucio">Configuring <code>&lt;path&gt;</code> for Storage Capabilities in Rucio:<a href="#configuring-path-for-storage-capabilities-in-rucio" class="hash-link" aria-label="Direct link to configuring-path-for-storage-capabilities-in-rucio" title="Direct link to configuring-path-for-storage-capabilities-in-rucio">​</a></h4>
<p>Each storage enforces a specific prefix for <code>storage.&lt;capability&gt;:&lt;path&gt;</code> scopes. There are two scenarios:</p>
<p><strong>Scenario 1: Storage Accepts Full RSE Protocol Prefix</strong></p>
<p>If your storage accepts the full RSE protocol prefix as-is, no additional configuration is needed.</p>
<p>Example:</p>
<ul>
<li>RSE protocol prefix: <code>/path/to/vo</code></li>
<li>Storage expects: <code>/path/to/vo</code></li>
</ul>
<p><strong>Scenario 2: Storage Expects Partial RSE Protocol Prefix</strong></p>
<p>If your storage expects only part of the RSE protocol prefix, use the <code>oidc_base_path</code> RSE attribute to strip the unwanted leading prefix.</p>
<p>Example:</p>
<ul>
<li>RSE protocol prefix: <code>/path/to/vo</code></li>
<li>Storage expects: <code>/vo</code></li>
<li>Action: Set <code>oidc_base_path</code> to remove <code>/path/to</code> as shown below.</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">rucio rse attribute add --key oidc_base_path --value &#x27;/path/to&#x27; RSE_NAME</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="transfer-daemon-token-flow">Transfer daemon token flow.<a href="#transfer-daemon-token-flow" class="hash-link" aria-label="Direct link to Transfer daemon token flow." title="Direct link to Transfer daemon token flow.">​</a></h4>
<ol>
<li>Transfer job submission to FTS</li>
</ol>
<p>For TPC transfer rucio sends 3 tokens to FTS.
<code>fts token [F]</code>, <code>src storage token [S]</code> and <code>destination storage token [D]</code>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>All tokens sent to FTS (<code>[F]</code>, <code>[S]</code>, <code>[D]</code>) are <strong>managed tokens</strong>.
This requires configuring FTS to perform <strong>token exchange and Just in Time token refresh</strong>, so long-running transfers continue even after the original tokens sent from Rucio expires.
More info <a href="https://fts3-docs.web.cern.ch/fts3-docs/docs/token_support.html" target="_blank" rel="noopener noreferrer">here</a> and <a href="https://fts3-docs.web.cern.ch/fts3-docs/docs/install/upgrades/3.14.html" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div>
<!-- -->
<ol start="2">
<li>
<p>Poller Daemon Token Support</p>
<p>For Poller to use tokens to communicate with FTS, add following to the config:</p>
<div class="language-cfg codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-cfg codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[conveyor]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">poller_oidc_support = True</span><br></span></code></pre></div></div>
<!-- -->
</li>
<li>
<p>Reaper (deletion) Daemon Token support.</p>
<p>If the RSE has token enabled and meet the criteria then its enough for deletion via token.</p>
<!-- -->
</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/rucio/documentation/tree/main/docs/../docs/operator/installing_server.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2026-01-21T20:37:04.000Z" itemprop="dateModified">Jan 21, 2026</time></b> by <b>Oshika Jain</b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/documentation/operator/kubernetes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Setting up Rucio on Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/documentation/operator/policy_packages/policy_packages_overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Policy Packages Overview</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#install-via-pip" class="table-of-contents__link toc-highlight">Install via pip</a></li><li><a href="#install-via-docker" class="table-of-contents__link toc-highlight">Install via Docker</a></li><li><a href="#environment-variables" class="table-of-contents__link toc-highlight">Environment Variables</a><ul><li><a href="#rucio_enable_ssl" class="table-of-contents__link toc-highlight">RUCIO_ENABLE_SSL</a></li><li><a href="#rucio_ssl_protocol" class="table-of-contents__link toc-highlight">RUCIO_SSL_PROTOCOL</a></li><li><a href="#rucio_ca_path" class="table-of-contents__link toc-highlight">RUCIO_CA_PATH</a></li><li><a href="#rucio_define_aliases" class="table-of-contents__link toc-highlight">RUCIO_DEFINE_ALIASES</a></li><li><a href="#rucio_enable_logs" class="table-of-contents__link toc-highlight">RUCIO_ENABLE_LOGS</a></li><li><a href="#rucio_log_level" class="table-of-contents__link toc-highlight">RUCIO_LOG_LEVEL</a></li><li><a href="#rucio_log_format" class="table-of-contents__link toc-highlight">RUCIO_LOG_FORMAT</a></li><li><a href="#rucio_hostname" class="table-of-contents__link toc-highlight">RUCIO_HOSTNAME</a></li><li><a href="#rucio_server_admin" class="table-of-contents__link toc-highlight">RUCIO_SERVER_ADMIN</a></li></ul></li><li><a href="#rucio_cfg-configuration-parameters" class="table-of-contents__link toc-highlight">RUCIO_CFG configuration parameters</a></li><li><a href="#enable-oidc" class="table-of-contents__link toc-highlight">Enable OIDC</a><ul><li><a href="#registering-oidc-clients-to-identity-provider-idp" class="table-of-contents__link toc-highlight">Registering OIDC Clients to Identity provider (IdP)</a></li><li><a href="#preparing-idpsecretsjson" class="table-of-contents__link toc-highlight">Preparing idpsecrets.json</a></li><li><a href="#configuring-rucio-server-for-oidc-based-authentication" class="table-of-contents__link toc-highlight">Configuring Rucio Server for OIDC based authentication</a></li><li><a href="#enabling-oidc-for-transfers--deletions" class="table-of-contents__link toc-highlight">Enabling OIDC for Transfers &amp; Deletions</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/documentation/img/rucio_horizontaled_black.svg" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/documentation/img/rucio_horizontaled_white.svg" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright © 2023 CERN</div></div></div></footer></div>
</body>
</html>