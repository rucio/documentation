<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Running rucio-conveyor-submitter · Rucio Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="```"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Running rucio-conveyor-submitter · Rucio Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://rucio.github.io/documentation/"/><meta property="og:description" content="```"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/documentation/img/android-chrome-512x512.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/documentation/css/custom.css"/><link rel="stylesheet" href="/documentation/prism/prism.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,500,700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Rubik:400,500,700&amp;display=swap"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;display=swap"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="/documentation/prism/prism.js"></script><script src="/documentation/js/scrollSpy.js"></script><link rel="stylesheet" href="/documentation/css/main.css"/><script src="/documentation/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/documentation/"><img class="logo" src="/documentation/img/wide_logo2.png" alt="Rucio Documentation"/></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/documentation/docs/" target="_self">Docs</a></li><li class=""><a href="https://rucio.readthedocs.io/_/downloads/en/next/pdf/" target="_self">Downloads</a></li><li class=""><a href="https://arxiv.org/abs/1902.09857" target="_self">Scientific articles</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Ask me something" title="Ask me something"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Running rucio-conveyor-submitter</h1></header><article><div><span><pre><code class="hljs">usage: rucio-conveyor-submitter [-h] [--run-once]
                                [--total-threads TOTAL_THREADS] [--bulk BULK]
                                [--group-bulk GROUP_BULK]
                                [--group-policy GROUP_POLICY] [--mock]
                                [--source-strategy SOURCE_STRATEGY]
                                [--exclude-rses EXCLUDE_RSES]
                                [--include-rses INCLUDE_RSES]
                                [--rses RSES [RSES <span class="hljs-built_in">..</span>.]] [--vos VOS [VOS <span class="hljs-built_in">..</span>.]]
                                [--activities ACTIVITIES [ACTIVITIES <span class="hljs-built_in">..</span>.]]
                                [--exclude-activities EXCLUDE_ACTIVITIES [EXCLUDE_ACTIVITIES <span class="hljs-built_in">..</span>.]]
                                [--sleep-time SLEEP_TIME]
                                [--max-sources MAX_SOURCES]
                                [--retry-other-fts]

The Conveyor-Submitter daemon is responsible <span class="hljs-keyword">for</span> managing non-tape file
transfers. It prepares transfer jobs <span class="hljs-keyword">and</span> submits them <span class="hljs-keyword">to</span> the transfertool.

optional arguments:
  -h, --help            show this help message <span class="hljs-keyword">and</span> exit
  --run-once            One iteration only
  --total-threads TOTAL_THREADS
                        Concurrency control: total number of threads per
                        process
  --bulk BULK           Bulk control: number of requests
  --group-bulk GROUP_BULK
                       <span class="hljs-built_in"> Group </span>control: number of requests per<span class="hljs-built_in"> group
</span>  --group-policy GROUP_POLICY
                       <span class="hljs-built_in"> Group </span>control:<span class="hljs-built_in"> policy </span>used <span class="hljs-keyword">to</span> group. enum{rule, dest,
                        src_dest, rule_src_dest, activity_dest,
                        activity_src_dest}
  --mock                Fake source replicas <span class="hljs-keyword">for</span> requests
  --source-strategy SOURCE_STRATEGY
                        Source strategy. Overload the strategy defined <span class="hljs-keyword">in</span>
                       <span class="hljs-built_in"> config </span>DB.
  --exclude-rses EXCLUDE_RSES
                        RSE expression <span class="hljs-keyword">to</span> exclude
  --include-rses INCLUDE_RSES
                        RSE expression <span class="hljs-keyword">to</span> include
  --rses RSES [RSES <span class="hljs-built_in">..</span>.]
                        Explicit list of RSEs <span class="hljs-keyword">to</span> include
  --vos VOS [VOS <span class="hljs-built_in">..</span>.]   Optional list of VOs <span class="hljs-keyword">to</span> consider. Only used <span class="hljs-keyword">in</span> multi-
                        VO mode.
  --activities ACTIVITIES [ACTIVITIES <span class="hljs-built_in">..</span>.]
                        Explicit list of activities <span class="hljs-keyword">to</span> include
  --exclude-activities EXCLUDE_ACTIVITIES [EXCLUDE_ACTIVITIES <span class="hljs-built_in">..</span>.]
                        Explicit list of activities <span class="hljs-keyword">to</span> exclude
  --sleep-time SLEEP_TIME
                        Seconds <span class="hljs-keyword">to</span> sleep <span class="hljs-keyword">if</span> few requests
  --max-sources MAX_SOURCES
                        Maximum source replicas per FTS job
  --retry-other-fts     retry on a different FTS

Upload a file <span class="hljs-keyword">and</span> create a replication rule:: $ rucio upload --scope mock
--rse MOCK --name file filename.txt $ rucio add-rule mock:file 1 MOCK2 $
rucio-admin rse add-distance MOCK2 MOCK --distance 1 --ranking 1 The rule
should replicate the file <span class="hljs-keyword">from</span> RSE MOCK <span class="hljs-keyword">to</span> RSE MOCK2. Therefor a distance
between these RSEs is needed. Check transfer requests <span class="hljs-keyword">for</span> the DID:: $ python
<span class="hljs-keyword">from</span> rucio.db.sqla import session,models
session.get_session().query(models.Request).filter_by(<span class="hljs-attribute">scope</span>=<span class="hljs-string">'mock'</span>,
<span class="hljs-attribute">name</span>=<span class="hljs-string">'file'</span>).first() # {<span class="hljs-string">'request_type'</span>: TRANSFER, <span class="hljs-string">'state'</span>: QUEUED<span class="hljs-string">', ...} A
queued request was created which can be picked uped by the Conveyor-Submiter
daemon. Run the daemon:: $ rucio-conveyor-submitter --run-once Check again the
transfer requests for the DID:: $ python from rucio.db.sqla import
session,models
session.get_session().query(models.Request).filter_by(scope='</span>mock<span class="hljs-string">',
name='</span>file<span class="hljs-string">').first() # {'</span>request_type<span class="hljs-string">': TRANSFER, '</span>state<span class="hljs-string">': SUBMITTED'</span>, <span class="hljs-built_in">..</span>.} A
tranfer request got created by executing the transfer. Depending on the
transfer submission, the request state can be different. <span class="hljs-keyword">In</span> this example the
transfer got submitted successfully. When <span class="hljs-builtin-name">run</span> <span class="hljs-keyword">in</span> multi-VO mode, by<span class="hljs-built_in"> default </span>the
daemon will <span class="hljs-builtin-name">run</span> on RSEs <span class="hljs-keyword">from</span> all VOs:: $ rucio-conveyor-submitter --run-once
2020-07-29 13:51:09,436 5784 <span class="hljs-builtin-name">INFO</span> This<span class="hljs-built_in"> instance </span>will work on VOs: def, abc,
xyz, 123 2020-07-29 13:51:13,315 5784 <span class="hljs-builtin-name">INFO</span> RSE selection: automatic <span class="hljs-keyword">for</span>
relevant VOs 2020-07-29 13:51:13,316 5784 <span class="hljs-builtin-name">INFO</span> starting submitter threads By
using the ``--vos`` argument only the VO <span class="hljs-keyword">or</span> VOs specified will be affected:: $
rucio-conveyor-submitter --run-once --vos abc xyz 2020-07-29 13:51:09,436 5784
<span class="hljs-builtin-name">INFO</span> This<span class="hljs-built_in"> instance </span>will work on VOs: abc, xyz 2020-07-29 13:51:13,315 5784
<span class="hljs-builtin-name">INFO</span> RSE selection: automatic <span class="hljs-keyword">for</span> relevant VOs 2020-07-29 13:51:13,316 5784
<span class="hljs-builtin-name">INFO</span> starting submitter threads<span class="hljs-built_in"> Note </span>that attempting the use the ``--vos``
argument when <span class="hljs-keyword">in</span> single-VO mode will have <span class="hljs-literal">no</span> affect:: $ rucio-conveyor-
submitter --run-once --vos abc xyz 2020-07-29 13:39:37,263 5752 <span class="hljs-builtin-name">INFO</span> RSE
selection: automatic 2020-07-29 13:39:37,264 5752 <span class="hljs-builtin-name">INFO</span> starting submitter
threads
</code></pre>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2021 CERN. Created with Docusaurus.</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '04e5d623b96121df11ac440e51fc8956',
                indexName: 'rucio-cern',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>