{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"rsemanager.html","title":"Rsemanager","text":""},{"location":"rsemanager.html#rucio.rse.rsemanager.get_scope_protocol","title":"<code>get_scope_protocol(vo='def')</code>","text":"<pre><code>Returns the callable protocol to translate the pfn to a name/scope pair\n</code></pre> <p>Returns:</p> Type Description <code>Callable</code> <p>Callable: Scope Parser function</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.get_rse_info","title":"<code>get_rse_info(rse=None, vo='def', rse_id=None, session=None)</code>","text":"<p>Returns all protocol related RSE attributes. Call with either rse and vo, or (in server mode) rse_id</p> <p>Parameters:</p> Name Type Description Default <code>rse</code> <p>Name of the requested RSE</p> <code>None</code> <code>vo</code> <p>The VO for the RSE.</p> <code>'def'</code> <code>rse_id</code> <p>The id of the rse (use in server mode to avoid db calls)</p> <code>None</code> <code>session</code> <p>The eventual database session.</p> <code>None</code> <p>Returns:</p> Type Description <code>RSESettingsDict</code> <p>a dict object with the following attributes: id                ...     an internal identifier rse               ...     the name of the RSE as string type              ...     the storage type odf the RSE e.g. DISK volatile          ...     boolean indicating if the RSE is volatile verify_checksum   ...     boolean indicating whether RSE supports requests for checksums deterministic      ...     boolean indicating of the naming of the files follows the defined determinism domain            ...     indicating the domain that should be assumed for transfers. Values are 'ALL', 'LAN', or 'WAN' protocols         ...     all supported protocol in form of a list of dict objects with the following structure - scheme              ...     protocol scheme e.g. http, srm, ... - hostname            ...     hostname of the site - prefix              ...     path to the folder where the files are stored - port                ...     port used for this protocol - impl                ...     naming the python class of the protocol implementation - extended_attributes ...     additional information for the protocol - domains             ...     a dict naming each domain and the priority of the protocol for each operation (lower is better, zero is not supported)</p> <p>Raises:</p> Type Description <code>RSENotFound</code> <p>if the provided RSE could not be found in the database.</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager._get_possible_protocols","title":"<code>_get_possible_protocols(rse_settings, operation, scheme=None, domain=None, impl=None)</code>","text":"<p>Filter the list of available protocols or provided by the supported ones.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>The rse settings.</p> required <code>operation</code> <p>The operation (write, read).</p> required <code>scheme</code> <p>Optional filter if no specific protocol is defined in rse_setting for the provided operation.</p> <code>None</code> <code>domain</code> <p>Optional domain (lan/wan), if not specified, both will be returned</p> <code>None</code> <p>Returns:</p> Type Description <p>The list of possible protocols.</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.create_protocol","title":"<code>create_protocol(rse_settings, operation, scheme=None, domain='wan', auth_token=None, protocol_attr=None, logger=logging.log, impl=None)</code>","text":"<p>Instantiates the protocol defined for the given operation.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>operation</code> <p>Intended operation for this protocol</p> required <code>scheme</code> <p>Optional filter if no specific protocol is defined in rse_setting for the provided operation</p> <code>None</code> <code>domain</code> <p>Optional specification of the domain</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>protocol_attr</code> <p>Optionally passing the full protocol availability information to correctly select WAN/LAN</p> <code>None</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>An instance of the requested protocol</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.lfns2pfns","title":"<code>lfns2pfns(rse_settings, lfns, operation='write', scheme=None, domain='wan', auth_token=None, logger=logging.log, impl=None)</code>","text":"<p>Convert the lfn to a pfn</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>lfns</code> <p>logical file names as a dict containing 'scope' and 'name' as keys. For bulk a list of dicts can be provided</p> required <code>operation</code> <p>Intended operation for this protocol</p> <code>'write'</code> <code>scheme</code> <p>Optional filter if no specific protocol is defined in rse_setting for the provided operation</p> <code>None</code> <code>domain</code> <p>Optional specification of the domain</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>a dict with scope:name as key and the PFN as value</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.parse_pfns","title":"<code>parse_pfns(rse_settings, pfns, operation='read', domain='wan', auth_token=None)</code>","text":"<p>Checks if a PFN is feasible for a given RSE. If so it splits the pfn in its various components.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>pfns</code> <p>list of PFNs</p> required <code>operation</code> <p>Intended operation for this protocol</p> <code>'read'</code> <code>domain</code> <p>Optional specification of the domain</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <p>Returns:</p> Type Description <p>A dict with the parts known by the selected protocol e.g. scheme, hostname, prefix, path, name</p> <p>Raises:</p> Type Description <code>RSEFileNameNotSupported</code> <p>if provided PFN is not supported by the RSE/protocol</p> <code>RSENotFound</code> <p>if the referred storage is not found i the repository (rse_id)</p> <code>InvalidObject</code> <p>If the properties parameter doesn't include scheme, hostname, and port as keys</p> <code>RSEOperationNotSupported</code> <p>If no matching protocol was found for the requested operation</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.exists","title":"<code>exists(rse_settings, files, domain='wan', scheme=None, impl=None, auth_token=None, vo='def', logger=logging.log)</code>","text":"<p>Checks if a file is present at the connected storage. Providing a list indicates the bulk mode.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>files</code> <p>a single dict or a list with dicts containing 'scope' and 'name' if LFNs are used and only 'name' if PFNs are used. E.g. {'name': '2_rse_remote_get.raw', 'scope': 'user.jdoe'}, {'name': 'user/jdoe/5a/98/3_rse_remote_get.raw'}</p> required <code>domain</code> <p>The network domain, either 'wan' (default) or 'lan'</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>vo</code> <p>The VO for the RSE</p> <code>'def'</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>True/False for a single file or a dict object with 'scope:name' for LFNs or 'name' for PFNs as keys and True or the exception as value for each file in bulk mode</p> <p>Raises:</p> Type Description <code>RSENotConnected</code> <p>no connection to a specific storage has been established</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.upload","title":"<code>upload(rse_settings, lfns, domain='wan', source_dir=None, force_pfn=None, force_scheme=None, transfer_timeout=None, delete_existing=False, sign_service=None, auth_token=None, vo='def', logger=logging.log, impl=None)</code>","text":"<p>Uploads a file to the connected storage. Providing a list indicates the bulk mode.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>lfns</code> <p>a single dict or a list with dicts containing 'scope' and 'name'. Examples: [ {'name': '1_rse_local_put.raw', 'scope': 'user.jdoe', 'filesize': 42, 'adler32': '87HS3J968JSNWID'}, {'name': '2_rse_local_put.raw', 'scope': 'user.jdoe', 'filesize': 4711, 'adler32': 'RSSMICETHMISBA837464F'} ] If the 'filename' key is present, it will be used by Rucio as the actual name of the file on disk (separate from the Rucio 'name').</p> required <code>domain</code> <p>The network domain, either 'wan' (default) or 'lan'</p> <code>'wan'</code> <code>source_dir</code> <p>path to the local directory including the source files</p> <code>None</code> <code>force_pfn</code> <p>use the given PFN -- can lead to dark data, use sparingly</p> <code>None</code> <code>force_scheme</code> <p>use the given protocol scheme, overriding the protocol priority in the RSE description</p> <code>None</code> <code>transfer_timeout</code> <p>set this timeout (in seconds) for the transfers, for protocols that support it</p> <code>None</code> <code>sign_service</code> <p>use the given service (e.g. gcs, s3, swift) to sign the URL</p> <code>None</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>vo</code> <p>The VO for the RSE</p> <code>'def'</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>True/False for a single file or a dict object with 'scope:name' as keys and True or the exception as value for each file in bulk mode</p> <p>Raises:</p> Type Description <code>RSENotConnected</code> <p>no connection to a specific storage has been established</p> <code>SourceNotFound</code> <p>local source file can not be found</p> <code>DestinationNotAccessible</code> <p>remote destination directory is not accessible</p> <code>ServiceUnavailable</code> <p>for any other reason</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.delete","title":"<code>delete(rse_settings, lfns, domain='wan', auth_token=None, logger=logging.log, impl=None)</code>","text":"<p>Delete a file from the connected storage. Providing a list indicates the bulk mode.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>lfns</code> <p>a single dict or a list with dicts containing 'scope' and 'name'. E.g. [{'name': '1_rse_remote_delete.raw', 'scope': 'user.jdoe'}, {'name': '2_rse_remote_delete.raw', 'scope': 'user.jdoe'}]</p> required <code>domain</code> <p>The network domain, either 'wan' (default) or 'lan'</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>True/False for a single file or a dict object with 'scope:name' as keys and True or the exception as value for each file in bulk mode</p> <p>Raises:</p> Type Description <code>RSENotConnected</code> <p>no connection to a specific storage has been established</p> <code>SourceNotFound</code> <p>remote source file can not be found on storage</p> <code>ServiceUnavailable</code> <p>for any other reason</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.rename","title":"<code>rename(rse_settings, files, domain='wan', auth_token=None, logger=logging.log, impl=None)</code>","text":"<p>Rename files stored on the connected storage. Providing a list indicates the bulk mode.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>files</code> <p>a single dict or a list with dicts containing 'scope', 'name', 'new_scope' and 'new_name' if LFNs are used or only 'name' and 'new_name' if PFNs are used. If 'new_scope' or 'new_name' are not provided, the current one is used. Examples: [ {'name': '3_rse_remote_rename.raw', 'scope': 'user.jdoe', 'new_name': '3_rse_new.raw', 'new_scope': 'user.jdoe'}, {'name': 'user/jdoe/d9/cb/9_rse_remote_rename.raw', 'new_name': 'user/jdoe/c6/4a/9_rse_new.raw'} ]</p> required <code>domain</code> <p>The network domain, either 'wan' (default) or 'lan'</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>True/False for a single file or a dict object with LFN (key) and True/False (value) in bulk mode</p> <p>Raises:</p> Type Description <code>RSENotConnected</code> <p>no connection to a specific storage has been established</p> <code>SourceNotFound</code> <p>remote source file can not be found on storage</p> <code>DestinationNotAccessible</code> <p>remote destination directory is not accessible</p> <code>ServiceUnavailable</code> <p>for any other reason</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.get_space_usage","title":"<code>get_space_usage(rse_settings, scheme=None, domain='wan', auth_token=None, logger=logging.log, impl=None)</code>","text":"<p>Get RSE space usage information.</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings</code> <code>RSESettingsDict</code> <p>RSE attributes</p> required <code>scheme</code> <p>optional filter to select which protocol to be used.</p> <code>None</code> <code>domain</code> <p>The network domain, either 'wan' (default) or 'lan'</p> <code>'wan'</code> <code>auth_token</code> <p>Optionally passing JSON Web Token (OIDC) string for authentication</p> <code>None</code> <code>logger</code> <p>Optional decorated logger that can be passed from the calling daemons or servers.</p> <code>log</code> <p>Returns:</p> Type Description <p>a list with dict containing 'totalsize' and 'unusedsize'</p> <p>Raises:</p> Type Description <code>ServiceUnavailable</code> <p>if some generic error occurred in the library.</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager.find_matching_scheme","title":"<code>find_matching_scheme(rse_settings_dest, rse_settings_src, operation_src, operation_dest, domain='wan', scheme=None)</code>","text":"<p>Find the best matching scheme between two RSEs</p> <p>Parameters:</p> Name Type Description Default <code>rse_settings_dest</code> <p>RSE settings for the destination RSE.</p> required <code>rse_settings_src</code> <p>RSE settings for the src RSE.</p> required <code>operation_src</code> <p>Source Operation such as read, write.</p> required <code>operation_dest</code> <p>Dest Operation such as read, write.</p> required <code>domain</code> <p>Domain such as lan, wan.</p> <code>'wan'</code> <code>scheme</code> <p>List of supported schemes.</p> <code>None</code> <p>Returns:</p> Type Description <p>Tuple of matching schemes (dest_scheme, src_scheme, dest_scheme_priority, src_scheme_priority).</p>"},{"location":"rsemanager.html#rucio.rse.rsemanager._retry_protocol_stat","title":"<code>_retry_protocol_stat(protocol, pfn)</code>","text":"<p>try to stat file, on fail try again 1s, 2s, 4s, 8s, 16s, 32s later. Fail is all fail</p> <p>Parameters:</p> Name Type Description Default <code>protocol</code> <p>The protocol to use to reach this file</p> required <code>pfn</code> <p>Physical file name of the target for the protocol stat</p> required"},{"location":"rsemanager.html#rucio.rse.rsemanager.__check_compatible_scheme","title":"<code>__check_compatible_scheme(dest_scheme, src_scheme)</code>","text":"<p>Check if two schemes are compatible, such as srm and gsiftp</p> <p>Parameters:</p> Name Type Description Default <code>dest_scheme</code> <p>Destination scheme</p> required <code>src_scheme</code> <p>Source scheme</p> required <code>scheme</code> <p>List of supported schemes</p> required <p>Returns:</p> Type Description <p>True if schemes are compatible, False otherwise.</p>"},{"location":"translation.html","title":"Translation","text":""},{"location":"translation.html#rucio.rse.translation.RSEDeterministicScopeTranslation","title":"<code>RSEDeterministicScopeTranslation(vo='def')</code>","text":"<p>Translates a pfn dictionary into a scope and name</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicScopeTranslation._module_init_","title":"<code>_module_init_()</code>  <code>classmethod</code>","text":"<p>Registers the included scope extraction algorithms</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicScopeTranslation.register","title":"<code>register(pfn2lfn_callable, name=None)</code>  <code>classmethod</code>","text":"<p>Provided a callable function, register it as one of the valid PFN2LFN algorithms.</p> <p>Parameters:</p> Name Type Description Default <code>pfn2lfn_callable</code> <code>Callable</code> <p>Callable function to use.</p> required <code>name</code> <code>Optional[str]</code> <p>Algorithm name used for registration.</p> <code>None</code>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicScopeTranslation._default","title":"<code>_default(parsed_pfn)</code>  <code>staticmethod</code>","text":"<p>Translate pfn to name/scope pair</p> <p>Parameters:</p> Name Type Description Default <code>parsed_pfn</code> <code>Mapping[str, str]</code> <p>dictionary representing pfn containing: - path: str, - name: str</p> required <p>Returns:</p> Type Description <code>tuple[str, str]</code> <p>tuple containing name, scope</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation","title":"<code>RSEDeterministicTranslation(rse=None, rse_attributes=None, protocol_attributes=None)</code>","text":"<p>Execute the logic for translating a LFN to a path.</p> <p>Initialize a translator object from the RSE, its attributes, and the protocol-specific attributes.</p> <p>Parameters:</p> Name Type Description Default <code>rse</code> <p>Name of RSE for this translation.</p> <code>None</code> <code>rse_attributes</code> <p>A dictionary of RSE-specific attributes for use in the translation.</p> <code>None</code> <code>protocol_attributes</code> <p>A dictionary of RSE/protocol-specific attributes.</p> <code>None</code>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation.supports","title":"<code>supports(name)</code>  <code>classmethod</code>","text":"<p>Check to see if a specific algorithm is supported.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <p>Name of the deterministic algorithm.</p> required <p>Returns:</p> Type Description <p>True if <code>name</code> is an algorithm supported by the translator class, False otherwise</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation.register","title":"<code>register(lfn2pfn_callable, name=None)</code>  <code>classmethod</code>","text":"<p>Provided a callable function, register it as one of the valid LFN2PFN algorithms.</p> <p>The callable will receive five arguments:  - scope: Scope of the LFN.  - name: LFN's path name  - rse: RSE name the translation is being done for.  - rse_attributes: Attributes of the RSE.  - protocol_attributes: Attributes of the RSE's protocol The return value should be the last part of the PFN - it will be appended to the rest of the URL.</p> <p>Parameters:</p> Name Type Description Default <code>lfn2pfn_callable</code> <p>Callable function to use for generating paths.</p> required <code>name</code> <p>Algorithm name used for registration.  If None, then <code>lfn2pfn_callable.__name__</code> is used.</p> <code>None</code>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation.__hash","title":"<code>__hash(scope, name, rse, rse_attrs, protocol_attrs)</code>  <code>staticmethod</code>","text":"<p>Given a LFN, turn it into a sub-directory structure using a hash function.</p> <p>This takes the MD5 of the LFN and uses the first four characters as a subdirectory name.</p> <p>Parameters:</p> Name Type Description Default <code>scope</code> <p>Scope of the LFN.</p> required <code>name</code> <p>File name of the LFN.</p> required <code>rse</code> <p>RSE for PFN (ignored)</p> required <code>rse_attrs</code> <p>RSE attributes for PFN (ignored)</p> required <code>protocol_attrs</code> <p>RSE protocol attributes for PFN (ignored)</p> required <p>Returns:</p> Type Description <p>Path for use in the PFN generation.</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation.__identity","title":"<code>__identity(scope, name, rse, rse_attrs, protocol_attrs)</code>  <code>staticmethod</code>","text":"<p>Given a LFN, convert it directly to a path using the mapping:</p> <pre><code>scope:path -&gt; scope/path\n</code></pre> <p>Parameters:</p> Name Type Description Default <code>scope</code> <p>Scope of the LFN.</p> required <code>name</code> <p>File name of the LFN.</p> required <code>rse</code> <p>RSE for PFN (ignored)</p> required <code>rse_attrs</code> <p>RSE attributes for PFN (ignored)</p> required <code>protocol_attrs</code> <p>RSE protocol attributes for PFN (ignored)</p> required <p>Returns:</p> Type Description <p>Path for use in the PFN generation.</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation._module_init_","title":"<code>_module_init_()</code>  <code>classmethod</code>","text":"<p>Initialize the class object on first module load.</p>"},{"location":"translation.html#rucio.rse.translation.RSEDeterministicTranslation.path","title":"<code>path(scope, name)</code>","text":"<p>Transforms the logical file name into a PFN's path.</p> <p>Parameters:</p> Name Type Description Default <code>lfn</code> <p>filename</p> required <code>scope</code> <p>scope</p> required <p>Returns:</p> Type Description <p>RSE specific URI of the physical file</p>"}]}