"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[50682],{11821(e,a,t){t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>d,default:()=>p,frontMatter:()=>s,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"operator/open_data","title":"Open Data","description":"Rucio has native support for Open Data which was introduced in v38.0.0.","source":"@site/../docs/operator/open_data.md","sourceDirName":"operator","slug":"/operator/open_data","permalink":"/documentation/operator/open_data","draft":false,"unlisted":false,"editUrl":"https://github.com/rucio/documentation/tree/main/docs/../docs/operator/open_data.md","tags":[],"version":"current","lastUpdatedBy":"Benedikt Ziemons","lastUpdatedAt":1768917542000,"frontMatter":{"id":"open_data","title":"Open Data","sidebar_label":"Open Data"},"sidebar":"docs","previous":{"title":"Notifications","permalink":"/documentation/operator/notifications"},"next":{"title":"QoS RSE Configuration","permalink":"/documentation/operator/qos_rse_config"}}');var i=t(74848),o=t(28453);const s={id:"open_data",title:"Open Data",sidebar_label:"Open Data"},d=void 0,l={},c=[{value:"Open Data CLI",id:"open-data-cli",level:2},{value:"Adding a DID to the Open Data catalog",id:"adding-a-did-to-the-open-data-catalog",level:3},{value:"Updating an Open Data DID",id:"updating-an-open-data-did",level:3},{value:"Public Open Data",id:"public-open-data",level:2},{value:"REST API",id:"rest-api",level:2},{value:"Open Data replication rules",id:"open-data-replication-rules",level:2}];function r(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.p,{children:["Rucio has native support for Open Data which was introduced in ",(0,i.jsx)(a.code,{children:"v38.0.0"}),".\nIt is an evolving feature and allows to tag already registered Rucio DIDs as Open Data and to add additional metadata (json-compatible).\nRucio is able to expose these Open Data DIDs in a dedicated Open Data endpoint, returning useful information such as a list with all Open Data DIDs or the Open Data details of a given DID."]}),"\n",(0,i.jsx)(a.h2,{id:"open-data-cli",children:"Open Data CLI"}),"\n",(0,i.jsx)(a.h3,{id:"adding-a-did-to-the-open-data-catalog",children:"Adding a DID to the Open Data catalog"}),"\n",(0,i.jsx)(a.p,{children:"Any Rucio DID can be added to the Open Data catalog."}),"\n",(0,i.jsx)(a.p,{children:"This command will create a Rucio DID to use in this tutorial (skip if you already have some DIDs to work with)."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio scope add demo --account root\n\nDID=demo:demo-1\nrucio did add --type dataset $DID\n"})}),"\n",(0,i.jsx)(a.p,{children:"To add a DID to the Open Data catalog:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did add $DID\n"})}),"\n",(0,i.jsxs)(a.p,{children:["A list of all Open Data DIDs may be fetched by the following command. It accepts additional option such as filters.\nSince the initial state of an Open Data DID is ",(0,i.jsx)(a.code,{children:"draft"}),", we can filter for that."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did list --state draft\n"})}),"\n",(0,i.jsx)(a.p,{children:"We can also show details for a given Open Data DID"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did show $DID --files --meta\n"})}),"\n",(0,i.jsxs)(a.p,{children:["this command supports multiple flags, such as ",(0,i.jsx)(a.code,{children:"files"})," used to list all the files for this DID or ",(0,i.jsx)(a.code,{children:"meta"})," to show Open Data metadata."]}),"\n",(0,i.jsxs)(a.p,{children:["The ",(0,i.jsx)(a.code,{children:"--public"})," flag can also be used to perform the request against the Open Data public endpoint. This will only work if the Open Data DID is marked as public in the Open Data catalog."]}),"\n",(0,i.jsx)(a.h3,{id:"updating-an-open-data-did",children:"Updating an Open Data DID"}),"\n",(0,i.jsx)(a.p,{children:"The Open Data DIDs can be enriched with some additional Open Data specific metadata."}),"\n",(0,i.jsx)(a.p,{children:"A DOI can be added to the DID via"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did update $DID --doi 10.1234/abcd.56789\n"})}),"\n",(0,i.jsx)(a.p,{children:"The DOI must be a valid DOI string and globally unique in the Rucio Open Data catalog."}),"\n",(0,i.jsx)(a.p,{children:"A JSON object may be added as Open Data metadata"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:'rucio opendata did update $DID --meta \'{"key":"value"}\'\n'})}),"\n",(0,i.jsxs)(a.p,{children:["This Open Data metadata will be available in the ",(0,i.jsx)(a.code,{children:"show"})," command and in the"]}),"\n",(0,i.jsx)(a.h2,{id:"public-open-data",children:"Public Open Data"}),"\n",(0,i.jsxs)(a.p,{children:["An Open Data DID can be marked as ",(0,i.jsx)(a.code,{children:"public"}),".\nPublic Open Data DIDs will be exposed publicly in the Rucio server without the need of any kind of authentication."]}),"\n",(0,i.jsx)(a.p,{children:"In order to become public, the DID must be closed if not a file."}),"\n",(0,i.jsx)(a.p,{children:"A Rucio DID may be closed via the following command"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio did update --close $DID\n"})}),"\n",(0,i.jsx)(a.p,{children:"After the DID is closed, it can be set to public via"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did update $DID --state public\n"})}),"\n",(0,i.jsxs)(a.p,{children:["An Open Data DID can be reverted to a non-public state by transferring it to the ",(0,i.jsx)(a.code,{children:"suspended"})," state."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-shell",children:"rucio opendata did update $DID --state suspended\n"})}),"\n",(0,i.jsxs)(a.p,{children:["There is an exclusive Rucio endpoint for public Open Data called ",(0,i.jsx)(a.code,{children:"opendata_public"}),".\nFor production deployments we recommend a dedicated Rucio server with only the ",(0,i.jsx)(a.code,{children:"opendata_public"})," enabled, as this server instance is able to process unauthenticated requests.\nIf this server is accessible to other services related to Open Data such as the Open Data Portal, it can provide updated information related to the Open Data DIDs registered in Rucio."]}),"\n",(0,i.jsx)(a.h2,{id:"rest-api",children:"REST API"}),"\n",(0,i.jsxs)(a.p,{children:["The ",(0,i.jsx)(a.a,{href:"https://rucio.cern.ch/documentation/html/rest_api_doc.html#tag/open_data",children:"REST API for Open Data"})," is available as part of the Rucio REST API documentation."]}),"\n",(0,i.jsx)(a.p,{children:"The most important feature is that users are able to send requests to the public Open Data endpoint without any kind of authentication.\nThis can be used to establish synchronization between Rucio and a third party app such as an Open Data Portal."}),"\n",(0,i.jsx)(a.h2,{id:"open-data-replication-rules",children:"Open Data replication rules"}),"\n",(0,i.jsxs)(a.p,{children:["It is possible to trigger the creation of a replication rule when an Open Data DID is set to ",(0,i.jsx)(a.code,{children:"public"}),"."]}),"\n",(0,i.jsxs)(a.p,{children:["All the available Rucio configuration options for the Open Data replication rules can be seen ",(0,i.jsx)(a.a,{href:"https://rucio.cern.ch/documentation/operator/configuration_parameters#opendata",children:"in the Rucio config parameters documentation page"}),"."]}),"\n",(0,i.jsx)(a.p,{children:"The rule option needs to be enabled and a valid RSE expression must be provided. Other options related to the rule can be set via configuration parameters, such as the rule account, number of copies or activity."}),"\n",(0,i.jsxs)(a.p,{children:["The rule will be created when the Open Data DID is set to public and the rule ",(0,i.jsx)(a.strong,{children:"will not be deleted"})," if the Open Data DID is set to another state or deleted from the Rucio Open Data catalog, the rule will still remain.\nThe rule can be deleted the same as with any other replication rule."]}),"\n",(0,i.jsxs)(a.p,{children:["It is possible to view the associated Open Data replication rule via the ",(0,i.jsx)(a.code,{children:"rucio opendata show"})," command."]})]})}function p(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},28453(e,a,t){t.d(a,{R:()=>s,x:()=>d});var n=t(96540);const i={},o=n.createContext(i);function s(e){const a=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function d(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),n.createElement(o.Provider,{value:a},e.children)}}}]);