"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[71407],{15802:(e,s,i)=>{i.r(s),i.d(s,{assets:()=>t,contentTitle:()=>o,default:()=>a,frontMatter:()=>l,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"release-notes/1.19.0.post2","title":"1.19.0.post2","description":"Upgrade Instructions","source":"@site/../docs/release-notes/1.19.0.post2.md","sourceDirName":"release-notes","slug":"/release-notes/1.19.0.post2","permalink":"/documentation/release-notes/1.19.0.post2","draft":false,"unlisted":false,"editUrl":"https://github.com/rucio/documentation/tree/main/docs/../docs/release-notes/1.19.0.post2.md","tags":[],"version":"current","frontMatter":{"title":"1.19.0.post2"}}');var r=i(74848),c=i(28453);const l={title:"1.19.0.post2"},o=void 0,t={},h=[{value:"Upgrade Instructions",id:"upgrade-instructions",level:2},{value:"General",id:"general",level:2},{value:"Features",id:"features",level:3},{value:"Enhancements",id:"enhancements",level:3},{value:"Bugs",id:"bugs",level:3},{value:"Clients",id:"clients",level:2},{value:"Features",id:"features-1",level:3},{value:"Enhancements",id:"enhancements-1",level:3},{value:"Bugs",id:"bugs-1",level:3},{value:"WebUI",id:"webui",level:2},{value:"Enhancements",id:"enhancements-2",level:3}];function d(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"upgrade-instructions",children:"Upgrade Instructions"}),"\n",(0,r.jsxs)(s.p,{children:["This feature release requires a database schema upgrade. Please consult the ",(0,r.jsx)(s.a,{href:"https://rucio.readthedocs.io/en/latest/database.html",children:"documentation"})," about upgrading your database schema."]}),"\n",(0,r.jsxs)(s.p,{children:["The following changes are necessary and are covered by the ",(0,r.jsx)(s.code,{children:"alembic upgrade head"})," command:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"bad_replicas_table"})," changes (Alembic revision ",(0,r.jsx)(s.code,{children:"b96a1c7e1cc4"}),")"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["New ",(0,r.jsx)(s.code,{children:"expires_at"})," column."]}),"\n",(0,r.jsx)(s.li,{children:"Primary key change."}),"\n",(0,r.jsxs)(s.li,{children:["New ",(0,r.jsx)(s.code,{children:"BAD_REPLICAS_EXPIRES_AT_IDX"})," Index."]}),"\n",(0,r.jsxs)(s.li,{children:["Constraint ",(0,r.jsx)(s.code,{children:"BAD_REPLICAS_STATE_CHK"})," change."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["New ",(0,r.jsx)(s.code,{children:"bad_pfns"})," table (Alembic revision ",(0,r.jsx)(s.code,{children:"b96a1c7e1cc4"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Change of ",(0,r.jsx)(s.code,{children:"rse_attr_map"})," and ",(0,r.jsx)(s.code,{children:"account_attr_map"})," boolean values (Alembic revision ",(0,r.jsx)(s.code,{children:"9eb936a81eb1"}),")"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"True"})," to ",(0,r.jsx)(s.code,{children:"true"})]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"False"})," to ",(0,r.jsx)(s.code,{children:"false"})]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Changes in history tables (Alembic revision ",(0,r.jsx)(s.code,{children:"bf3baa1c1474"}),")"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Drop of Primary Key ",(0,r.jsx)(s.code,{children:"CONTENTS_HIST_PK"})," for table ",(0,r.jsx)(s.code,{children:"contents_history"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of Primary Key ",(0,r.jsx)(s.code,{children:"ARCH_CONTENTS_HISOTRY_PK"})," for table ",(0,r.jsx)(s.code,{children:"archive_contents_history"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Creation of Index ",(0,r.jsx)(s.code,{children:"ARCH_CONT_HIST_IDX"})," for table ",(0,r.jsx)(s.code,{children:"archive_contents_history"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of Primary Key ",(0,r.jsx)(s.code,{children:"RULES_HIST_RECENT_PK"})," for table ",(0,r.jsx)(s.code,{children:"rules_hist_recent"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of column ",(0,r.jsx)(s.code,{children:"history_id"})," for table ",(0,r.jsx)(s.code,{children:"rules_hist_recent"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of Primary Key ",(0,r.jsx)(s.code,{children:"RULES_HIST_LONGTERM_PK"})," for table ",(0,r.jsx)(s.code,{children:"rules_history"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of column ",(0,r.jsx)(s.code,{children:"history_id"})," for table ",(0,r.jsx)(s.code,{children:"rules_history"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Drop of Primary Key ",(0,r.jsx)(s.code,{children:"MESSAGES_HIST_ID_PK"})," for table ",(0,r.jsx)(s.code,{children:"messages_history"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Adding of new ",(0,r.jsx)(s.code,{children:"payload_nolimit"})," column to messages tables (Alembic revision ",(0,r.jsx)(s.code,{children:"90f47792bb76"}),")"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Add column ",(0,r.jsx)(s.code,{children:"payload_nolimit"})," to table ",(0,r.jsx)(s.code,{children:"messages"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:["Add column ",(0,r.jsx)(s.code,{children:"payload_nolimit"})," to table ",(0,r.jsx)(s.code,{children:"messages_history"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Change of constraint ",(0,r.jsx)(s.code,{children:"RULES_NOTIFICATION_CHK"})," for ",(0,r.jsx)(s.code,{children:"rules"})," (Alembic revision ",(0,r.jsx)(s.code,{children:"01eaf73ab656"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Change of Primary Key ",(0,r.jsx)(s.code,{children:"REPLICAS_PK"})," for table ",(0,r.jsx)(s.code,{children:"replicas"})," (Alembic revision ",(0,r.jsx)(s.code,{children:"3345511706b8"}),")"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["The following change are necessary and are ",(0,r.jsx)(s.strong,{children:"NOT"})," covered by the ",(0,r.jsx)(s.code,{children:"alembic upgrade head"})," command:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["The boolean values upgrade on the ",(0,r.jsx)(s.code,{children:"rse_attr_map"})," and ",(0,r.jsx)(s.code,{children:"account_attr_map"})," tables from ",(0,r.jsx)(s.code,{children:"0"})," to ",(0,r.jsx)(s.code,{children:"false"})," and ",(0,r.jsx)(s.code,{children:"1"})," to ",(0,r.jsx)(s.code,{children:"true"})," need to be executed manually, since the script cannot distinguish between the integer or boolean interpretation of the attribute. It is very important that you only upgrade ",(0,r.jsx)(s.code,{children:"0"})," and ",(0,r.jsx)(s.code,{children:"1"})," which actually correspond to boolean values, otherwise functionality might be degraded (Alembic revision ",(0,r.jsx)(s.code,{children:"9eb936a81eb1"}),")"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"rucio-conveyor-transfer-submitter"})," daemon was removed with this release. The functionality is fully covered by the ",(0,r.jsx)(s.code,{children:"rucio-conveyor-submitter"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"general",children:"General"}),"\n",(0,r.jsx)(s.h3,{id:"features",children:"Features"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Mark replicas as temporarily unavailable ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1550",children:"#1550"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: PK in history tables mostly wrong ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1818",children:"#1818"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Limit the maximum space usage on an RSE ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1965",children:"#1965"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Messages payload are limited to 4000 characters and throw exception ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/48",children:"#48"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: json based import for RSEs, protocols, distances ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/716",children:"#716"})]}),"\n",(0,r.jsxs)(s.li,{children:["Rules: New Rule Notification Mode ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1922",children:"#1922"})]}),"\n",(0,r.jsxs)(s.li,{children:["Transfers: Remove conveyor-transfer-submitter ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1632",children:"#1632"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"enhancements",children:"Enhancements"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Clients: Allow upload of replicas to non-det RSEs by users ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1172",children:"#1172"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Core migration to python3 ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1912",children:"#1912"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Daemon migration to python3 ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1924",children:"#1924"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: fix last python3 incompatibilities ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1961",children:"#1961"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Add missing wsgi alias for import/export ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1990",children:"#1990"})]}),"\n",(0,r.jsxs)(s.li,{children:["Messaging: improve connection handling to broker ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1479",children:"#1479"})]}),"\n",(0,r.jsxs)(s.li,{children:["Rebalancing: bb8 - replacing sql query with sql alchemy ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1861",children:"#1861"})]}),"\n",(0,r.jsxs)(s.li,{children:["Rebalancing: BB8 should avoid reducing the replication factor of a dataset ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/484",children:"#484"})]}),"\n",(0,r.jsxs)(s.li,{children:["Release management: Address security issue in paramiko due to CVE-2018-1000805 ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1646",children:"#1646"})]}),"\n",(0,r.jsxs)(s.li,{children:["Release management: Upgrade of dependencies for 1.19.0 ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2028",children:"#2028"})]}),"\n",(0,r.jsxs)(s.li,{children:["Release management: Rucio py3 compatibility ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/67",children:"#67"})]}),"\n",(0,r.jsxs)(s.li,{children:["Testing: switch oracle image for travis tests ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2010",children:"#2010"})]}),"\n",(0,r.jsxs)(s.li,{children:["Traces: kronos: activemq connect is missing wait=True ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/321",children:"#321"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"bugs",children:"Bugs"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Core & Internals: Primary Key for replicas table is in wrong order in models.py ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1749",children:"#1749"})]}),"\n",(0,r.jsxs)(s.li,{children:["Core & Internals: list-rse-usage with --show-accounts does not work ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2040",children:"#2040"})]}),"\n",(0,r.jsxs)(s.li,{children:["Deletion: The reaper may ignore some rses if there is more than one rse handled per thread ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1729",children:"#1729"})]}),"\n",(0,r.jsxs)(s.li,{children:["Deletion: Reaper crashes if no RSEs are defined ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1917",children:"#1917"})]}),"\n",(0,r.jsxs)(s.li,{children:["Documentation: Documentation build fails ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1774",children:"#1774"})]}),"\n",(0,r.jsxs)(s.li,{children:["Documentation: Broken links in documentation sidebar ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2065",children:"#2065"})]}),"\n",(0,r.jsxs)(s.li,{children:["Probes & Alarms: The FTS probe sometimes doesn't whitelist a SE after the end of downtime ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2015",children:"#2015"})]}),"\n",(0,r.jsxs)(s.li,{children:["Probes & Alarms: Synchronisation with VOMS fails under Nagios due to non-ASCII characters ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2051",children:"#2051"})]}),"\n",(0,r.jsxs)(s.li,{children:["Rebalancing: BB8 crash with RSEBlacklisted exception ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/313",children:"#313"})]}),"\n",(0,r.jsxs)(s.li,{children:["Release management: Define stricter depdency ranges for pip-requires-client ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1692",children:"#1692"})]}),"\n",(0,r.jsxs)(s.li,{children:["Transfers: REST call for requests is broken by '/' in DIDs ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1791",children:"#1791"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"clients",children:"Clients"}),"\n",(0,r.jsx)(s.h3,{id:"features-1",children:"Features"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Clients: Expose request details (e.g. FTS job ID) to the client ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1786",children:"#1786"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"enhancements-1",children:"Enhancements"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Clients: rucio download should be able to use locally cached metalink ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1415",children:"#1415"})]}),"\n",(0,r.jsxs)(s.li,{children:["Clients: Handling of istape=False in the client ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/1455",children:"#1455"})]}),"\n",(0,r.jsxs)(s.li,{children:["Clients: fix python3 incompatibilities not found by pylint ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2020",children:"#2020"})]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"bugs-1",children:"Bugs"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Clients: authentication type selection safeguard ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2006",children:"#2006"})]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"webui",children:"WebUI"}),"\n",(0,r.jsx)(s.h3,{id:"enhancements-2",children:"Enhancements"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["WebUI: View for suspicious files ",(0,r.jsx)(s.a,{href:"https://github.com/rucio/rucio/issues/2054",children:"#2054"})]}),"\n"]})]})}function a(e={}){const{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,s,i)=>{i.d(s,{R:()=>l,x:()=>o});var n=i(96540);const r={},c=n.createContext(r);function l(e){const s=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),n.createElement(c.Provider,{value:s},e.children)}}}]);