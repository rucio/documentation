"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6913],{3224:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/undertaker-112c2af198c6c6d3aee798acbefae95f.png"},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>d});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}},42434:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"started/concepts/deletion_overview","title":"Deletion Overview","description":"Deletion in Rucio can be performed in broadly two ways.","source":"@site/../docs/started/concepts/deletion_overview.md","sourceDirName":"started/concepts","slug":"/started/concepts/deletion_overview","permalink":"/documentation/started/concepts/deletion_overview","draft":false,"unlisted":false,"editUrl":"https://github.com/rucio/documentation/tree/main/docs/../docs/started/concepts/deletion_overview.md","tags":[],"version":"current","lastUpdatedBy":"dependabot[bot]","lastUpdatedAt":1743416689000,"frontMatter":{"id":"deletion_overview","title":"Deletion Overview"},"sidebar":"docs","previous":{"title":"Typical Replica Workflow","permalink":"/documentation/started/concepts/replica_workflow"},"next":{"title":"Release Policy","permalink":"/documentation/started/releasepolicy"}}');var s=n(74848),r=n(28453);const o={id:"deletion_overview",title:"Deletion Overview"},d=void 0,c={},a=[];function l(e){const t={code:"code",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"Deletion in Rucio can be performed in broadly two ways."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Rule based deletion:"}),"\n",(0,s.jsxs)(t.p,{children:["Each rule has a corresponding lifetime associated with it (default is None). The attribute ",(0,s.jsx)(t.code,{children:"expires_at"})," of the rule is the time when the lifetime is set plus the lifetime associated with the rule.\nAdditionally each rule can be ",(0,s.jsx)(t.code,{children:"locked"})," for additional protection. If a rule is locked the rule is protected from expiration.\nThe ",(0,s.jsx)(t.code,{children:"Judge-cleaner"})," daemon is responsible for handling expired rules. If an expired rule is not locked it sets ",(0,s.jsx)(t.code,{children:"tombstones"})," on all replicas not covered by the rule anymore (or any other rule). These replicas then become eligible for deletion."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"DID based deletion:"}),"\n",(0,s.jsxs)(t.p,{children:["Additionally, each DID also has a lifetime associated with it (default is None). The metadata ",(0,s.jsx)(t.code,{children:"expires_at"})," of the DID is calculated similarly to a rule.\nThe ",(0,s.jsx)(t.code,{children:"Undertaker"})," daemon is responsible for handling expired DIDs. The daemon checks if none of the associated rules to the DID are locked, if not it removes all rules of the DID (see section above). The DID itself is then removed from the catalog."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"The DID expiration overrules the rule expiration. But the locked rules are protected."})}),"\n",(0,s.jsxs)(t.p,{children:["After the tombstone is set for replicas, the actual data deletion is done by the ",(0,s.jsx)(t.code,{children:"Reaper"})," daemon. The reaper physically deletes the tombstoned replicas from storage.\nThe deletion service supports two different modes: greedy and non-greedy."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Greedy"}),"\n",(0,s.jsx)(t.p,{children:"The reaper daemon gets all the replicas with tombstone in the RSE and immediately deletes all replicas."}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsx)(t.p,{children:"Non-greedy"}),"\n",(0,s.jsx)(t.p,{children:"The reaper daemon first checks if the free space is needed in the RSE. The needed free space is the difference of minimum free space (attribute set for RSE) and actual free space in RSE. Deletion only occurs once free space is needed.\nDeletions are processed by Least Recently Used (LRU) algorithm, thus oldest accessed (tombstoned) replicas are deleted first."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Judge-cleaner chart",src:n(84023).A+"",width:"1780",height:"2308"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Undertaker chart",src:n(3224).A+"",width:"1780",height:"2308"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Reaper chart",src:n(43618).A+"",width:"2640",height:"3628"})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},43618:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/reaper-3ac7e1c52fa6c8df1cd80887c4c94315.png"},84023:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/judge-cleaner-3d62b87007e66579e73e50b413eecdfb.png"}}]);