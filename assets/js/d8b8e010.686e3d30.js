"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[36637],{89725(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"operator/rse_configuration","title":"RSE Configuration Guide","description":"This section provides an overview of Rucio Storage Elements (RSEs) from an operator\'s perspective, covering setup, configuration, and best practices.","source":"@site/../docs/operator/rse_configuration.md","sourceDirName":"operator","slug":"/operator/rse_configuration","permalink":"/documentation/operator/rse_configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/rucio/documentation/tree/main/docs/../docs/operator/rse_configuration.md","tags":[],"version":"current","lastUpdatedBy":"Luis Antonio Obis Aparicio","lastUpdatedAt":1771455789000,"frontMatter":{},"sidebar":"docs","previous":{"title":"QoS RSE Configuration","permalink":"/documentation/operator/qos_rse_config"},"next":{"title":"S3 Storage Configuration","permalink":"/documentation/operator/s3_rse_config"}}');var r=i(74848),s=i(28453);const o={},l="RSE Configuration Guide",c={},a=[{value:"RSE Configuration Concepts",id:"rse-configuration-concepts",level:2},{value:"RSE Settings vs Attributes",id:"rse-settings-vs-attributes",level:3},{value:"Protocols",id:"protocols",level:3},{value:"Account Limits",id:"account-limits",level:3},{value:"RSE Setup Methods",id:"rse-setup-methods",level:2},{value:"Method 1: Using the Rucio CLI",id:"method-1-using-the-rucio-cli",level:3},{value:"Method 2: Using the Python Client API",id:"method-2-using-the-python-client-api",level:3},{value:"RSE Configuration Examples",id:"rse-configuration-examples",level:2},{value:"FILE/POSIX RSEs",id:"fileposix-rses",level:3},{value:"WebDAV RSEs",id:"webdav-rses",level:3},{value:"Rucio Configuration",id:"rucio-configuration",level:4},{value:"Disk RSEs",id:"disk-rses",level:3},{value:"Tape RSEs",id:"tape-rses",level:3},{value:"Setting RSE Attributes",id:"setting-rse-attributes",level:3},{value:"Protocols",id:"protocols-1",level:2},{value:"Protocol Priority",id:"protocol-priority",level:3},{value:"Domain Configuration",id:"domain-configuration",level:3},{value:"Account Limits",id:"account-limits-1",level:2},{value:"Setting Limits",id:"setting-limits",level:3},{value:"Non-Deterministic RSEs",id:"non-deterministic-rses",level:2},{value:"Key Differences from Deterministic RSEs",id:"key-differences-from-deterministic-rses",level:3},{value:"Setup Example",id:"setup-example",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. RSE Distance Configuration",id:"1-rse-distance-configuration",level:3},{value:"2. Protocol Selection",id:"2-protocol-selection",level:3},{value:"3. Prefix Planning",id:"3-prefix-planning",level:3},{value:"4. Security",id:"4-security",level:3},{value:"5. Monitoring",id:"5-monitoring",level:3},{value:"6. Tape-Specific",id:"6-tape-specific",level:3},{value:"7. Testing",id:"7-testing",level:3},{value:"8. Common Pitfalls",id:"8-common-pitfalls",level:3},{value:"Additional Resources",id:"additional-resources",level:2},{value:"Quick Reference Commands",id:"quick-reference-commands",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"rse-configuration-guide",children:"RSE Configuration Guide"})}),"\n",(0,r.jsx)(n.p,{children:"This section provides an overview of Rucio Storage Elements (RSEs) from an operator's perspective, covering setup, configuration, and best practices."}),"\n",(0,r.jsx)(n.p,{children:"The Rucio Storage Elements (RSEs) are the fundamental storage endpoints in a Rucio deployment. They represent physical or logical storage locations where data files are stored."}),"\n",(0,r.jsx)(n.h2,{id:"rse-configuration-concepts",children:"RSE Configuration Concepts"}),"\n",(0,r.jsx)(n.p,{children:"Before diving into the setup methods, it's important to understand the main concepts that define RSE configuration:"}),"\n",(0,r.jsx)(n.h3,{id:"rse-settings-vs-attributes",children:"RSE Settings vs Attributes"}),"\n",(0,r.jsxs)(n.p,{children:["Rucio distinguishes between ",(0,r.jsx)(n.strong,{children:"RSE settings"})," (properties of the RSE itself) and ",(0,r.jsx)(n.strong,{children:"RSE attributes"})," (key-value metadata)."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RSE Settings"})," (configured via ",(0,r.jsx)(n.code,{children:"rucio rse update"})," or ",(0,r.jsx)(n.code,{children:"RSEClient.update_rse()"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rse_type"}),": Defines whether the RSE is ",(0,r.jsx)(n.code,{children:"DISK"})," or ",(0,r.jsx)(n.code,{children:"TAPE"})," (defaults to ",(0,r.jsx)(n.code,{children:"DISK"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"verify_checksum"}),": Boolean controlling checksum verification"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"deterministic"}),": Boolean controlling whether RSE uses deterministic file paths"]}),"\n",(0,r.jsxs)(n.li,{children:["Geographic fields: ",(0,r.jsx)(n.code,{children:"city"}),", ",(0,r.jsx)(n.code,{children:"country_name"}),", ",(0,r.jsx)(n.code,{children:"latitude"}),", ",(0,r.jsx)(n.code,{children:"longitude"}),", ",(0,r.jsx)(n.code,{children:"region_code"}),", ",(0,r.jsx)(n.code,{children:"time_zone"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["More can be found in the ",(0,r.jsx)(n.a,{href:"configuration_parameters/#rse-settings",children:"RSE Settings configuration page"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"RSE Attributes"})," (configured via ",(0,r.jsx)(n.code,{children:"rucio rse attribute add"})," or ",(0,r.jsx)(n.code,{children:"RSEClient.add_rse_attribute()"}),"):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lfn2pfn_algorithm"}),": Algorithm name for generating physical paths on ",(0,r.jsx)(n.strong,{children:"deterministic RSEs"})," (defaults to ",(0,r.jsx)(n.code,{children:"lfn2pfn_algorithm_default"})," from policy config if not set)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"naming_convention"}),": Algorithm name for generating physical file names on ",(0,r.jsx)(n.strong,{children:"non-deterministic RSEs"})," (typically tape systems)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"fts"}),": FTS endpoint URL (required only if using FTS for third-party transfers)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"archive_timeout"}),": Timeout for tape archival completion"]}),"\n",(0,r.jsx)(n.li,{children:"Storage characteristics, transfer policies, monitoring endpoints"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Important Configuration Notes",type:"danger",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RSE Type"}),": Set via ",(0,r.jsx)(n.code,{children:"rucio rse update --rse RSE_NAME --rse-type TAPE"})," (not as an attribute). Defaults to ",(0,r.jsx)(n.code,{children:"DISK"})," if omitted."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"FTS Endpoint"}),": Only required if your deployment uses FTS for transfers. Set as an attribute: ",(0,r.jsx)(n.code,{children:"rucio rse attribute add --rse RSE_NAME --key fts --value https://fts.example.com:8446"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"LFN2PFN Algorithm"}),": Must be set as an RSE attribute during initial setup. This is effectively immutable and should be chosen carefully based on whether your RSE is deterministic."]}),"\n"]})}),"\n",(0,r.jsxs)(n.p,{children:["An exhaustive list of RSE attributes can be found in the ",(0,r.jsx)(n.a,{href:"configuration_parameters/#rse-attributes",children:"configuration parameters page"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"protocols",children:"Protocols"}),"\n",(0,r.jsx)(n.p,{children:"Protocols define the methods clients use to access data on an RSE. Each protocol specifies:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scheme"}),": The access protocol (e.g., ",(0,r.jsx)(n.code,{children:"https"}),", ",(0,r.jsx)(n.code,{children:"root"}),", ",(0,r.jsx)(n.code,{children:"davs"}),", see ",(0,r.jsx)(n.a,{href:"https://rucio.cern.ch/documentation/html/transfer_protocols/posix.html",children:"RSE Protocols Documentation"})," for more information)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Hostname/Port"}),": Network endpoint for the storage system"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Prefix"}),": Base path for file storage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Implementation"}),": Python class handling protocol operations"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Domains"}),": Separate configurations for local (LAN) and remote (WAN) access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Operations"}),": Supported operations (read, write, delete, third-party copy)"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Multiple protocols can be configured for a single RSE, allowing different access methods for different use cases."}),"\n",(0,r.jsx)(n.h3,{id:"account-limits",children:"Account Limits"}),"\n",(0,r.jsx)(n.p,{children:"Account limits (also called quotas) control how much storage space a Rucio account can consume on a specific RSE. Limits are:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Set per account per RSE"}),"\n",(0,r.jsxs)(n.li,{children:["Specified in bytes (or as ",(0,r.jsx)(n.code,{children:"infinity"})," for unlimited)"]}),"\n",(0,r.jsx)(n.li,{children:"Enforced by Rucio's replication rules and placement decisions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Without appropriate limits, accounts cannot create replicas on an RSE."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rse-setup-methods",children:"RSE Setup Methods"}),"\n",(0,r.jsx)(n.p,{children:"There are two primary methods for setting up RSEs in Rucio:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Command Line Interface (CLI)"}),": Using the ",(0,r.jsx)(n.code,{children:"rucio"})," CLI tool"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Python API"}),": Using the Rucio core Python library"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Both methods achieve the same result. Choose the method that best fits your workflow."}),"\n",(0,r.jsx)(n.h3,{id:"method-1-using-the-rucio-cli",children:"Method 1: Using the Rucio CLI"}),"\n",(0,r.jsx)(n.p,{children:"The CLI approach is straightforward and suitable for interactive setup or shell scripts."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Basic workflow:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# 1. Add the RSE\nrucio rse add RSE_NAME\n\n# 2. Set RSE type\nrucio rse update RSE_NAME --key rse_type --value DISK  # or TAPE\n\n# 3. Add attributes\nrucio rse attribute add RSE_NAME --key attribute_name --value attribute_value\n\n# 4. Add protocol(s)\nrucio rse protocol add --host hostname --scheme scheme --prefix /path \\\n  --port port --impl implementation \\\n  --domain-json \'{"wan": {...}, "lan": {...}}\' \\\n  RSE_NAME\n\n# 5. Set account limits\nrucio account limit add account_name --rse RSE_NAME --bytes quota\n'})}),"\n",(0,r.jsx)(n.h3,{id:"method-2-using-the-python-client-api",children:"Method 2: Using the Python Client API"}),"\n",(0,r.jsx)(n.p,{children:"The Python Client API is the recommended approach for automation, complex configurations, or when integrating with other Python tools."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Basic workflow:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\nfrom rucio.client.rseclient import RSEClient\nfrom rucio.client.accountlimitclient import AccountLimitClient\n\n# Initialize clients\nrse_client = RSEClient()\naccount_limit_client = AccountLimitClient()\n\n# 1. Add the RSE\nrse_client.add_rse(rse='RSE_NAME', rse_type='DISK')  # or rse_type='TAPE'\n\n# 2. Add attributes\nrse_client.add_rse_attribute(rse='RSE_NAME', key='lfn2pfn_algorithm', value='identity')\n#rse_client.add_rse_attribute(rse='RSE_NAME', key='attribute_name', value='attribute_value')\n\n# 3. Add protocol\nparams = {\n    'scheme': 'https',\n    'hostname': 'hostname',\n    'port': 443,\n    'prefix': '/path',\n    'impl': 'rucio.rse.protocols.gfal.Default',\n    'domains': {\n        'lan': {'read': 1, 'write': 1, 'delete': 1},\n        'wan': {'read': 1, 'write': 1, 'delete': 1,\n                'third_party_copy_read': 1, 'third_party_copy_write': 1}\n    }\n}\nrse_client.add_protocol('RSE_NAME', params)\n\n# 4. Set account limits\naccount_limit_client.set_account_limit('account_name', 'RSE_NAME', bytes_limit)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rse-configuration-examples",children:"RSE Configuration Examples"}),"\n",(0,r.jsx)(n.h3,{id:"fileposix-rses",children:"FILE/POSIX RSEs"}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["POSIX RSEs use the ",(0,r.jsx)(n.code,{children:"file://"})," protocol and require direct filesystem access. They work when the Rucio server and clients can access the same filesystem path (e.g., via a shared mount). They are suitable for testing, single-node deployments, or when all components share a filesystem."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using CLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Add the RSE, named POSIX_RSE\nrucio rse add POSIX_RSE\n\n# Set backend type\nrucio rse attribute add --key backend_type --value POSIX POSIX_RSE\n\n# Configure storage usage monitoring\nrucio rse attribute add --key storage_usage_tool \\\n  --value \'rucio.rse.protocols.posix.Default.getSpace\' POSIX_RSE\n# Add protocol\nrucio rse protocol add --host localhost \\\n  --scheme file --prefix \'/data/posix-rse-1\' \\\n  --impl \'rucio.rse.protocols.posix.Default\' \\\n  --domain-json \'{"lan": {"read": 1, "write": 1, "delete": 1}, "wan": {"read": 1, "write": 1, "delete": 1}}\' POSIX_RSE\n\n# Set account limits\nrucio account limit add --rse POSIX_RSE --bytes infinity root\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"webdav-rses",children:"WebDAV RSEs"}),"\n",(0,r.jsx)(n.p,{children:"WebDAV RSEs provide remote access where external clients need to upload and download files."}),"\n",(0,r.jsx)(n.h4,{id:"rucio-configuration",children:"Rucio Configuration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using CLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'RUCIO_RSE_NAME="WEBDAV_RSE"\nHOST="webdav.example.com"\nPREFIX="/webdav"\n\n# Add RSE\nrucio rse add $RUCIO_RSE_NAME\n\n# Set RSE type if needed (defaults to DISK)\n# rucio rse update --rse-type DISK $RUCIO_RSE_NAME\n\n# Set attributes\nrucio rse attribute add --key lfn2pfn_algorithm --value identity $RUCIO_RSE_NAME\nrucio rse attribute add --key fts --value https://fts.example.com:8446 $RUCIO_RSE_NAME\nrucio rse attribute add --key greedyDeletion --value true $RUCIO_RSE_NAME\n\n# Update settings\nrucio rse update --verify-checksum false $RUCIO_RSE_NAME\n\n# Add davs protocol\nrucio rse protocol add --host $HOST $RUCIO_RSE_NAME \\\n  --scheme davs --prefix $PREFIX --port 8443 \\\n  --impl rucio.rse.protocols.gfal.Default \\\n  --domain-json \'{"wan": {"read": 1, "write": 1, "delete": 1, "third_party_copy_read": 1, "third_party_copy_write": 1}, "lan": {"read": 1, "write": 1, "delete": 1}}\'\n\n# Set account limits\nrucio account limit add --rse $RUCIO_RSE_NAME --bytes infinity root\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Python Client API:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\nfrom rucio.client.rseclient import RSEClient\n\n# Initialize client\nrse_client = RSEClient()\n\n# Add RSE (defaults to DISK type)\nrse_client.add_rse('WEBDAV_RSE')\n\n# Set attributes\nrse_client.add_rse_attribute(rse='WEBDAV_RSE', key='lfn2pfn_algorithm', value='identity')\nrse_client.add_rse_attribute(rse='WEBDAV_RSE', key='fts', value='https://fts.example.com:8446')\nrse_client.add_rse_attribute(rse='WEBDAV_RSE', key='greedyDeletion', value=True)\n\n# Update settings\nrse_client.update_rse(rse='WEBDAV_RSE', parameters={'verify_checksum': False})\n\n# Protocol parameters\nparams = {\n    'scheme': 'davs',\n    'prefix': '/webdav',\n    'hostname': 'webdav.example.com',\n    'port': 8443,\n    'impl': 'rucio.rse.protocols.gfal.Default',\n    'domains': {\n        \"lan\": {\n            \"read\": 1,\n            \"write\": 1,\n            \"delete\": 1,\n            \"third_party_copy_read\": 1,\n            \"third_party_copy_write\": 1\n        },\n        \"wan\": {\n            \"read\": 1,\n            \"write\": 1,\n            \"delete\": 1,\n            \"third_party_copy_read\": 1,\n            \"third_party_copy_write\": 1\n        }\n    }\n}\n\n# Setup protocol\nrse_client.add_protocol('WEBDAV_RSE', params)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"disk-rses",children:"Disk RSEs"}),"\n",(0,r.jsx)(n.p,{children:"Disk RSEs provide fast access to active data and are typically backed by systems like EOS."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using CLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'RUCIO_RSE_NAME="EXAMPLE_DISK_RSE"\nHOST="storage.example.com"\nPREFIX="/storage/rucio" # If using EOS, note that the path is //eos/your-path\n\n# Create RSE\nrucio rse add $RUCIO_RSE_NAME\n\n# Set RSE type and attributes\nrucio rse update $RUCIO_RSE_NAME --key rse_type --value DISK\nrucio rse attribute add $RUCIO_RSE_NAME --key lfn2pfn_algorithm --value identity\nrucio rse attribute add $RUCIO_RSE_NAME --key fts --value https://fts.example.com:8446\n\n# Add HTTPS protocol (primary for transfers)\nrucio rse protocol add --host $HOST $RUCIO_RSE_NAME \\\n  --scheme https \\\n  --prefix $PREFIX \\\n  --port 8444 \\\n  --impl rucio.rse.protocols.gfal.Default \\\n  --domain-json \'{"wan": {"read": 1, "write": 1, "delete": 1, "third_party_copy_read": 1, "third_party_copy_write": 1}, "lan": {"read": 1, "write": 1, "delete": 1}}\'\n\n# Add ROOT protocol (alternative access method)\nrucio rse protocol add --host $HOST $RUCIO_RSE_NAME \\\n  --scheme root \\\n  --prefix $PREFIX \\\n  --port 1094 \\\n  --impl rucio.rse.protocols.gfal.Default \\\n  --domain-json \'{"wan": {"read": 1, "write": 1, "delete": 1, "third_party_copy_read": 1, "third_party_copy_write": 1}, "lan": {"read": 1, "write": 1, "delete": 1}}\'\n\n# Set account limits\nrucio account limit add root --rse $RUCIO_RSE_NAME --bytes infinity\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Python Client API:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\nfrom rucio.client.rseclient import RSEClient\n\n# Initialize client\nrse_client = RSEClient()\n\n# Add RSE (defaults to DISK type)\nrse_client.add_rse('EXAMPLE_DISK_RSE')\n\n# Set attributes\nrse_client.add_rse_attribute(rse='EXAMPLE_DISK_RSE', key='lfn2pfn_algorithm', value='identity')\nrse_client.add_rse_attribute(rse='EXAMPLE_DISK_RSE', key='fts', value='https://fts.example.com:8446')\n\n# Add HTTPS protocol\nhttps_params = {\n    'scheme': 'https',\n    'hostname': 'storage.example.com',\n    'port': 8444,\n    'prefix': '/storage/rucio',\n    'impl': 'rucio.rse.protocols.gfal.Default',\n    'domains': {\n        'lan': {'read': 1, 'write': 1, 'delete': 1},\n        'wan': {'read': 1, 'write': 1, 'delete': 1,\n                'third_party_copy_read': 1, 'third_party_copy_write': 1}\n    }\n}\nrse_client.add_protocol('EXAMPLE_DISK_RSE', https_params)\n\n# Add ROOT protocol\nroot_params = {\n    'scheme': 'root',\n    'hostname': 'storage.example.com',\n    'port': 1094,\n    'prefix': '/storage/rucio',\n    'impl': 'rucio.rse.protocols.gfal.Default',\n    'domains': {\n        'lan': {'read': 1, 'write': 1, 'delete': 1},\n        'wan': {'read': 1, 'write': 1, 'delete': 1,\n                'third_party_copy_read': 1, 'third_party_copy_write': 1}\n    }\n}\nrse_client.add_protocol('EXAMPLE_DISK_RSE', root_params)\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Both ",(0,r.jsx)(n.code,{children:"https"})," and ",(0,r.jsx)(n.code,{children:"root"})," protocols are defined for flexibility"]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"identity"})," algorithm means the scope is appended to the prefix path"]}),"\n",(0,r.jsx)(n.li,{children:"Multiple deployments can share the same prefix if they use different scopes"}),"\n"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"tape-rses",children:"Tape RSEs"}),"\n",(0,r.jsx)(n.p,{children:"Tape RSEs are used for long-term archival storage with higher latency but larger capacity."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using CLI:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'RUCIO_RSE_NAME="EXAMPLE_TAPE_RSE"\nHOST="tape-storage.example.com"\nPREFIX="/tape/archive" # If using EOS, note that the path is //eos/your-path\n\n# Create RSE\nrucio rse add $RUCIO_RSE_NAME\n\n# Set RSE type and attributes\nrucio rse update $RUCIO_RSE_NAME --key rse_type --value TAPE\nrucio rse attribute add $RUCIO_RSE_NAME --key lfn2pfn_algorithm --value identity\nrucio rse attribute add $RUCIO_RSE_NAME --key fts --value https://fts.example.com:8446\nrucio rse attribute add $RUCIO_RSE_NAME --key archive_timeout --value 86400\n\n# Add HTTPS protocol only (root protocol can cause issues with tape)\nrucio rse protocol add --host $HOST $RUCIO_RSE_NAME \\\n  --scheme https \\\n  --prefix $PREFIX \\\n  --port 8444 \\\n  --impl rucio.rse.protocols.gfal.Default \\\n  --domain-json \'{"wan": {"read": 1, "write": 1, "delete": 1, "third_party_copy_read": 1, "third_party_copy_write": 1}, "lan": {"read": 1, "write": 1, "delete": 1}}\'\n\n# Set account limits\nrucio account limit add root --rse $RUCIO_RSE_NAME --bytes infinity\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Python Client API:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python\nfrom rucio.client.rseclient import RSEClient\n\n# Initialize client\nrse_client = RSEClient()\n\n# Add RSE with TAPE type\nrse_client.add_rse('EXAMPLE_TAPE_RSE', rse_type='TAPE')\n\n# Set attributes\nrse_client.add_rse_attribute(rse='EXAMPLE_TAPE_RSE', key='lfn2pfn_algorithm', value='identity')\nrse_client.add_rse_attribute(rse='EXAMPLE_TAPE_RSE', key='fts', value='https://fts.example.com:8446')\nrse_client.add_rse_attribute(rse='EXAMPLE_TAPE_RSE', key='archive_timeout', value=86400)\n\n# Add HTTPS protocol\nparams = {\n    'scheme': 'https',\n    'hostname': 'tape-storage.example.com',\n    'port': 8444,\n    'prefix': '/tape/archive',\n    'impl': 'rucio.rse.protocols.gfal.Default',\n    'domains': {\n        'lan': {'read': 1, 'write': 1, 'delete': 1},\n        'wan': {'read': 1, 'write': 1, 'delete': 1,\n                'third_party_copy_read': 1, 'third_party_copy_write': 1}\n    }\n}\nrse_client.add_protocol('EXAMPLE_TAPE_RSE', params)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Differences from Disk RSEs:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"rse_type"})," is set to ",(0,r.jsx)(n.code,{children:"TAPE"})," at creation time"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"archive_timeout"})," attribute specifies maximum time for file staging (86400 = 24 hours)"]}),"\n",(0,r.jsxs)(n.li,{children:["Typically only ",(0,r.jsx)(n.code,{children:"https"})," protocol is defined (avoid ",(0,r.jsx)(n.code,{children:"root"})," protocol for tape)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"setting-rse-attributes",children:"Setting RSE Attributes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Using rucio CLI\nrucio rse attribute add RSE_NAME --key attribute_name --value attribute_value\n\n# Using Python Client API\nfrom rucio.client.rseclient import RSEClient\nrse_client = RSEClient()\nrse_client.add_rse_attribute(rse='RSE_NAME', key='attribute_name', value='attribute_value')\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"protocols-1",children:"Protocols"}),"\n",(0,r.jsxs)(n.p,{children:["Protocols define how clients access data on an RSE. Multiple protocols can be defined for the same RSE.\nSee the ",(0,r.jsx)(n.a,{href:"https://rucio.cern.ch/documentation/html/transfer_protocols/posix.html",children:"RSE Protocols Documentation"})," for a full list of parameters."]}),"\n",(0,r.jsx)(n.h3,{id:"protocol-priority",children:"Protocol Priority"}),"\n",(0,r.jsxs)(n.p,{children:["The priority values in the ",(0,r.jsx)(n.code,{children:"domain-json"})," determine which protocol operations are enabled:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"1"})," to enable an operation"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"0"})," to disable an operation"]}),"\n",(0,r.jsx)(n.li,{children:"Omitting an operation key indicates it's not supported"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example:"})," For a read-only RSE, set ",(0,r.jsx)(n.code,{children:'"write": 0, "delete": 0'})," in the domains configuration."]}),"\n",(0,r.jsx)(n.h3,{id:"domain-configuration",children:"Domain Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "lan": {\n    "read": 1,\n    "write": 1,\n    "delete": 1\n  },\n  "wan": {\n    "read": 1,\n    "write": 1,\n    "delete": 1,\n    "third_party_copy_read": 1,\n    "third_party_copy_write": 1\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"lan"}),": Local Area Network (same site)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"wan"}),": Wide Area Network (remote sites)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"third_party_copy"}),": Direct transfers between RSEs via FTS"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"account-limits-1",children:"Account Limits"}),"\n",(0,r.jsx)(n.p,{children:"Account limits control how much space an account can use on an RSE."}),"\n",(0,r.jsx)(n.h3,{id:"setting-limits",children:"Setting Limits"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set unlimited quota for root account\nrucio account limit add root --rse RSE_NAME --bytes infinity\n\n# Set specific quota (in bytes)\nrucio account limit add user_account --rse RSE_NAME --bytes 1TB\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"non-deterministic-rses",children:"Non-Deterministic RSEs"}),"\n",(0,r.jsx)(n.p,{children:"Non-deterministic RSEs don't follow the standard deterministic logical-to-physical file naming convention. This is most common for tape systems where physical filenames are generated based on file metadata, dataset membership, or other factors beyond just scope and name."}),"\n",(0,r.jsx)(n.h3,{id:"key-differences-from-deterministic-rses",children:"Key Differences from Deterministic RSEs"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Deterministic RSEs"})," (typical disk systems):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"lfn2pfn_algorithm"})," ",(0,r.jsx)(n.strong,{children:"setting"})," to derive physical paths from scope and name alone"]}),"\n",(0,r.jsx)(n.li,{children:"Support both direct uploads and replications"}),"\n",(0,r.jsx)(n.li,{children:"Physical file path can be computed on-demand from the logical file name"}),"\n",(0,r.jsxs)(n.li,{children:["Example: File ",(0,r.jsx)(n.code,{children:"scope:name"})," \u2192 ",(0,r.jsx)(n.code,{children:"/storage/rucio/scope/name"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Non-Deterministic RSEs"})," (typical tape systems):"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"naming_convention"})," ",(0,r.jsx)(n.strong,{children:"attribute"})," to generate physical filenames"]}),"\n",(0,r.jsx)(n.li,{children:"The algorithm may use file metadata, dataset membership, creation time, etc."}),"\n",(0,r.jsx)(n.li,{children:"Only support replications (not direct uploads from clients)"}),"\n",(0,r.jsx)(n.li,{children:"Physical file paths must be registered explicitly when files are replicated"}),"\n",(0,r.jsxs)(n.li,{children:["Example: File might be stored as ",(0,r.jsx)(n.code,{children:"/tape/2026/02/03/archive_12345.tar"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"setup-example",children:"Setup Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'RUCIO_RSE_NAME="EXPERIMENT_TAPE_RSE"\n\n# Add as non-deterministic RSE\nrucio rse add --non-deterministic $RUCIO_RSE_NAME\n\n# Set type and attributes\nrucio rse update --key rse_type --value TAPE $RUCIO_RSE_NAME\nrucio rse attribute add --key naming_convention --value experiment_tape $RUCIO_RSE_NAME\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"When to Use:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tape systems with internal file organization requiring metadata-driven naming"}),"\n",(0,r.jsx)(n.li,{children:"Storage systems that don't support directory structures"}),"\n",(0,r.jsx)(n.li,{children:"Any storage backend where the physical filename cannot be deterministically computed from LFN alone"}),"\n"]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.p,{children:"For non-deterministic RSEs:"}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Physical file paths must be registered explicitly during replication"}),"\n",(0,r.jsx)(n.li,{children:"Files cannot be uploaded directly by clients (only via replication)"}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.code,{children:"naming_convention"})," attribute must reference a ",(0,r.jsx)(n.code,{children:"non_deterministic_pfn"})," algorithm in your ",(0,r.jsx)(n.a,{href:"policy_packages/policy_packages_overview",children:"policy package"})]}),"\n",(0,r.jsxs)(n.li,{children:["Do NOT set ",(0,r.jsx)(n.code,{children:"lfn2pfn_algorithm"})," setting on non-deterministic RSEs"]}),"\n"]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"1-rse-distance-configuration",children:"1. RSE Distance Configuration"}),"\n",(0,r.jsx)(n.p,{children:"RSE distance must be properly configured for transfers to work between RSEs."}),"\n",(0,r.jsxs)(n.admonition,{title:"Critical",type:"danger",children:[(0,r.jsx)(n.p,{children:"Please ensure to set distances in both directions if transfers are bidirectional."}),(0,r.jsxs)(n.p,{children:["See the ",(0,r.jsx)(n.a,{href:"../started/concepts/rucio_storage_element/#distances-between-rses",children:(0,r.jsx)(n.strong,{children:"related storage documentation"})})," for more details."]})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Set distance between RSEs (lower value = closer)\nrucio rse distance add --distance 1 SOURCE_RSE DEST_RSE\n# Set reverse distance if needed\nrucio rse distance add --distance 1 DEST_RSE SOURCE_RSE\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-protocol-selection",children:"2. Protocol Selection"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Disk RSEs:"})," Define both ",(0,r.jsx)(n.code,{children:"https"})," and ",(0,r.jsx)(n.code,{children:"root"})," protocols for flexibility"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Tape RSEs:"})," Use only ",(0,r.jsx)(n.code,{children:"https"})," protocol to avoid timeout issues"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Testing:"})," Use ",(0,r.jsx)(n.code,{children:"file://"})," protocol for local development only"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-prefix-planning",children:"3. Prefix Planning"}),"\n",(0,r.jsxs)(n.p,{children:["When using the ",(0,r.jsx)(n.code,{children:"identity"})," lfn2pfn algorithm, the scope is appended to the prefix:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use generic prefixes like ",(0,r.jsx)(n.code,{children:"/storage/rucio"})," or ",(0,r.jsx)(n.code,{children:"/data/experiment"})]}),"\n",(0,r.jsx)(n.li,{children:"Each deployment can use the same prefix with different scopes"}),"\n",(0,r.jsxs)(n.li,{children:["Example: Files with scope ",(0,r.jsx)(n.code,{children:"mydata"})," will be under ",(0,r.jsx)(n.code,{children:"/storage/rucio/mydata/"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"4-security",children:"4. Security"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Certificates:"})," Keep host certificates up to date"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Access Control:"})," Set appropriate account limits"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SELinux:"})," Ensure proper context for web-accessible directories"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"5-monitoring",children:"5. Monitoring"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set ",(0,r.jsx)(n.code,{children:"storage_usage_tool"})," for RSE space monitoring"]}),"\n",(0,r.jsx)(n.li,{children:"Configure FTS endpoint for transfer tracking"}),"\n",(0,r.jsx)(n.li,{children:"Enable logging for protocol operations"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"6-tape-specific",children:"6. Tape-Specific"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Set reasonable ",(0,r.jsx)(n.code,{children:"archive_timeout"})," values (24 hours recommended). This controls how long FTS waits for file staging to complete"]}),"\n",(0,r.jsx)(n.li,{children:"Use staging-aware clients for file retrieval"}),"\n",(0,r.jsxs)(n.li,{children:["Avoid ",(0,r.jsx)(n.code,{children:"root://"})," protocol for tape systems"]}),"\n",(0,r.jsx)(n.li,{children:"Monitor staging queue length"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"7-testing",children:"7. Testing"}),"\n",(0,r.jsx)(n.p,{children:"Before deploying to production:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Test file upload/download"}),"\n",(0,r.jsx)(n.li,{children:"Verify checksum handling"}),"\n",(0,r.jsx)(n.li,{children:"Test third-party copy between RSEs"}),"\n",(0,r.jsx)(n.li,{children:"Check deletion operations"}),"\n",(0,r.jsx)(n.li,{children:"Validate account limits"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"8-common-pitfalls",children:"8. Common Pitfalls"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Forgetting to set RSE distances"}),"\n",(0,r.jsx)(n.li,{children:"Wrong file permissions on WebDAV directories"}),"\n",(0,r.jsx)(n.li,{children:"Missing SELinux context"}),"\n",(0,r.jsxs)(n.li,{children:["Using ",(0,r.jsx)(n.code,{children:"root://"})," protocol for tape RSEs"]}),"\n",(0,r.jsx)(n.li,{children:"Not setting FTS endpoint for transfers"}),"\n",(0,r.jsx)(n.li,{children:"Insufficient archive timeout for tape staging"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"additional-resources",children:"Additional Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://fts3-docs.web.cern.ch/",children:"FTS3 Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://eos-docs.web.cern.ch/",children:"EOS Documentation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"https://eoscta.docs.cern.ch/",children:"CTA Documentation"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"quick-reference-commands",children:"Quick Reference Commands"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# List all RSEs\nrucio rse list\n\n# Show RSE details\nrucio rse show RSE_NAME\n\n# List RSE attributes\nrucio rse attribute list RSE_NAME\n\n# List account limits\nrucio account limit list ACCOUNT_NAME\n\n# Test file upload\nrucio upload --rse RSE_NAME --scope SCOPE file.txt\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453(e,n,i){i.d(n,{R:()=>o,x:()=>l});var t=i(96540);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);